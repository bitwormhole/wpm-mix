"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[365],{9698:function(e,t,a){a.d(t,{Z:function(){return c}});var l=a(3396),i=a(7139),n=a(9242);const o={class:"utils-batch-tool-bar"},r={class:"the-count-box"};function s(e,t,a,s,d,m){return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("span",null,(0,i.zw)(a.title),1),(0,l._)("span",r,(0,i.zw)(m.count)+" 项 ",1),(0,l.WI)(e.$slots,"default",{},void 0,!0)],512)),[[n.F8,!m.hide]])}var d={name:"utils-batch-tool-bar",computed:{items(){let e=this.modelValue;return null==e&&(e=[]),e},count(){let e=this.items.length;return null==e?0:e},hide(){return!!this.hideEmpty&&this.count<=0}},props:{modelValue:Array,title:String,hideEmpty:Boolean}},m=a(89);const u=(0,m.Z)(d,[["render",s],["__scopeId","data-v-5c44dc71"]]);var c=u},4031:function(e,t,a){a.d(t,{Z:function(){return u}});var l=a(3396),i=a(7139);const n={class:"icon-parent"},o=["src","title"];function r(e,t,a,r,s,d){return(0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("img",{class:"icon-image",src:a.src,title:a.title,style:(0,i.j5)(d.imageStyle)},null,12,o)])}var s={computed:{imageStyle(){let e=this.size+"px";return{maxWidth:e,maxHeight:e}}},props:{src:String,size:Number,title:String}},d=a(89);const m=(0,d.Z)(s,[["render",r],["__scopeId","data-v-5e686d6f"]]);var u=m},5365:function(e,t,a){a.r(t),a.d(t,{default:function(){return te}});var l=a(3396);function i(e,t,a,i,n,o){const r=(0,l.up)("ClientViewIndex"),s=(0,l.up)("AdminFrame");return(0,l.wg)(),(0,l.j4)(s,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r)])),_:1})}const n=e=>((0,l.dD)("data-v-be2d93de"),e=e(),(0,l.Cn)(),e),o={class:"settings-mediae-index-page"},r=n((()=>(0,l._)("h1",null,"媒体文件",-1)));function s(e,t,a,i,n,s){const d=(0,l.up)("MyToolbar"),m=(0,l.up)("MyPager"),u=(0,l.up)("MyTable"),c=(0,l.up)("MyUpImageDialog");return(0,l.wg)(),(0,l.iD)("div",o,[r,(0,l.Wm)(d,{onAction:s.handleAction},null,8,["onAction"]),(0,l.Wm)(m,{class:"settings-mediae-index-pager"}),(0,l.Wm)(u),(0,l.Wm)(c,{modelValue:n.displayUploadDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>n.displayUploadDialog=e)},null,8,["modelValue"])])}var d=a(4870),m=a(9242),u=a(2748);const c={class:"toolbar"},p={name:"settings-mediae-toolbar",methods:{fire(e){let t={name:e};this.$emit("action",t)},insert(){this.fire("insert")},refresh(){this.fire("refresh")},importPresets(){this.fire("import-presets")},handleCommand(){}}};var h=Object.assign(p,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),i=(0,l.up)("el-button"),n=(0,l.up)("el-dropdown-item"),o=(0,l.up)("el-dropdown-menu"),r=(0,l.up)("el-dropdown");return(0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(i,{type:"default",onClick:e.refresh,title:"刷新"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.hYj))])),_:1})])),_:1},8,["onClick"]),(0,l.Wm)(i,{type:"default",onClick:e.insert,title:"添加"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1})])),_:1},8,["onClick"]),(0,l.wy)((0,l.Wm)(r,{style:{"margin-left":"15px"},onCommand:e.handleCommand},{dropdown:(0,l.w5)((()=>[(0,l.Wm)(o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,{command:"IMPORT_PRESET_MEDIAE"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 导入预置资源 ")])),_:1})])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(i,{type:"default",title:"更多"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.Tkc))])),_:1})])),_:1})])),_:1},8,["onCommand"]),[[m.F8,!1]])])}}}),g=a(89);const f=(0,g.Z)(h,[["__scopeId","data-v-83e2a40e"]]);var w=f;function _(e,t,a,i,n,o){const r=(0,l.up)("el-pagination");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(r,{"current-page":n.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>n.currentPage=e),"page-size":n.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>n.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:n.background,layout:"total, sizes, prev, pager, next",total:o.theCountItemsTotal,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var v={name:"settings-mediae-pager",computed:{theCountItemsTotal(){return this.$store.getters["media/total"]}},data(){return{currentPage:1,pageSize:10,background:!0}},methods:{handleSizeChange(e){let t=e,a=0;this.$store.commit("media/update",{index:a,size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit("media/update",{index:t})}}};const b=(0,g.Z)(v,[["render",_]]);var y=b;const W=["src"];function k(e,t,a,i,n,o){const r=(0,l.up)("el-table-column"),s=(0,l.up)("el-button"),d=(0,l.up)("el-table"),m=(0,l.up)("MyBatch"),u=(0,l.up)("MyItemDetailDialog");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(d,{data:o.items,"default-sort":{prop:"label",order:"descending"},onSelectionChange:o.handleSelectionChange},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{type:"selection"}),(0,l.Wm)(r,{prop:"url",label:"",width:"90"},{default:(0,l.w5)((e=>[(0,l._)("img",{class:"media-item-image",src:e.row.url},null,8,W)])),_:1}),(0,l.Wm)(r,{prop:"label",label:"名称",sortable:""}),(0,l.Wm)(r,{prop:"content_type",label:"类型",sortable:""}),(0,l.Wm)(r,{prop:"size",label:"大小",sortable:""}),(0,l.Wm)(r,{label:"操作",width:"170px"},{default:(0,l.w5)((e=>[(0,l.Wm)(s,{link:"",type:"primary",onClick:t=>o.handleClickItemDetail(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("详情")])),_:2},1032,["onClick"]),(0,l.Wm)(s,{link:"",type:"danger",onClick:t=>o.handleClickRemoveItem(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,l.Wm)(m,{modelValue:n.selectedItems,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedItems=e)},null,8,["modelValue"]),(0,l.Wm)(u,{modelValue:n.displayDetailDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>n.displayDetailDialog=e),target:e.theDetailDialogItem},null,8,["modelValue","target"])])}var C=a(2655);const U={style:{"margin-top":"10px"}};function D(e,t,a,i,n,o){const r=(0,l.up)("el-button"),s=(0,l.up)("BatchToolBar");return(0,l.wg)(),(0,l.iD)("div",U,[(0,l.Wm)(s,{modelValue:o.items,"onUpdate:modelValue":t[0]||(t[0]=e=>o.items=e),title:"批处理",hideEmpty:!0},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{type:"danger",onClick:o.handleDelete},{default:(0,l.w5)((()=>[(0,l.Uk)(" 删除 ")])),_:1},8,["onClick"]),(0,l.Wm)(r,{type:"primary",onClick:o.handlePutToBuffer},{default:(0,l.w5)((()=>[(0,l.Uk)(" 存入缓冲区 ")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])}var I=a(9698),z={name:"settings-intent-templates-batch",components:{BatchToolBar:I.Z},computed:{items(){return this.modelValue}},methods:{handleDelete(){let e=this.items;this.$store.dispatch("media/remove",{items:e})},handlePutToBuffer(){let e="mediae",t={};t[e]=this.items,this.$store.dispatch("jsonbuffer/put",{vo:t})}},props:{modelValue:Array}};const S=(0,g.Z)(z,[["render",D]]);var T=S,x=a(7139);const V={class:"info-parent"};function M(e,t,a,i,n,o){const r=(0,l.up)("MyIcon"),s=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),m=(0,l.up)("ElButton"),u=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(u,{title:"媒体文件详情","align-center":"",width:"800px"},{default:(0,l.w5)((()=>[(0,l._)("div",V,[(0,l.Wm)(r,{class:"info-icon",src:o.item.url,size:99,title:""},null,8,["src"]),(0,l.Wm)(d,{class:"info-form","label-width":"128px"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{label:"名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.name),1)])),_:1}),(0,l.Wm)(s,{label:"类型"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.content_type),1)])),_:1}),(0,l.Wm)(s,{label:"显示名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.label),1)])),_:1}),(0,l.Wm)(s,{label:"ID / UUID"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.id)+" / "+(0,x.zw)(o.item.uuid),1)])),_:1}),(0,l.Wm)(s,{label:"SHA-256"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.sha256sum),1)])),_:1}),(0,l.Wm)(s,{label:"大小"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.size),1)])),_:1}),(0,l.Wm)(s,{label:"创建时间"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.formatTime(o.item.created_at)),1)])),_:1}),(0,l.Wm)(s,{label:"修改时间"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.formatTime(o.item.updated_at)),1)])),_:1})])),_:1})]),(0,l._)("div",null,[(0,l.Wm)(m,{type:"default",onClick:o.close},{default:(0,l.w5)((()=>[(0,l.Uk)("关闭")])),_:1},8,["onClick"])])])),_:1})}var P=a(6465),Z=a(4031),A=a(9466),B={name:"settings-local-repository-item-detail-dialog",components:{ElButton:P.mi,MyIcon:Z.Z},computed:{item(){return this.target}},methods:{formatTime(e){return A.Z.StringifyTimestamp(e,"datetime")},close(){this.$emit("update:modelValue",!1)}},props:{target:Object}};const $=(0,g.Z)(B,[["render",M],["__scopeId","data-v-985fcc6c"]]);var j=$,E={name:"settings-mediae-table",components:{MyBatch:T,MyItemDetailDialog:j},computed:{items(){return this.$store.getters["media/list"]}},data(){return{selectedItems:[],theDetailDialogTarget:{},displayDetailDialog:!1}},methods:{handleClickItemDetail(){},handleClickRemoveItem(e){let t="移除媒体文件",a="确定要移除 ["+e.name+"] 这个媒体文件吗？",l="注意：移除该文件可能会导致引用它的内容显示不正常！";C.T.confirm(a+l,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},handleClickItemDetail(e){this.theDetailDialogItem=e,this.displayDetailDialog=!0},removeItem(e){this.$store.dispatch("media/remove",{item:e})},handleSelectionChange(e){this.selectedItems=e}}};const R=(0,g.Z)(E,[["render",k],["__scopeId","data-v-db4d1498"]]);var F=R,O=(a(7658),a(7178));const H=["src"];function L(){}const N={name:"update-up-dialog",data(){return{imageUrl:"",vo:{},item:{},fileprops:[{name:"",value:""}]}},methods:{handleAvatarSuccess(e,t){L(e);let a=e,l=a.mediae[0];this.vo=a,this.item=l,this.fileprops=this.makeFileProps(l),this.imageUrl=URL.createObjectURL(t.raw)},makeFileProps(e){const t={name:"文件名",size:"大小",content_type:"类型",sha256sum:"SHA-256"};let a=[];for(var l in t){let i=t[l],n=e[l];a.push({name:i,value:n})}return a},beforeAvatarUpload(e){return this.acceptType(e.type)?!(e.size/1024/1024>2)||(O.z8.error("文件太大了，最多支持 2MB!"),!1):(O.z8.error("不支持的文件格式!"),console.warn("不支持的文件格式: "+e.type),!1)},acceptType(e){const t=["image/jpeg","image/png","image/gif","image/svg","image/webp","image/svg+xml"];for(var a in t){let l=t[a];if(l==e)return!0}return!1},save(){let e=this.item;this.$store.dispatch("media/insert",{item:e}).then((()=>{this.close()}))},cancel(){this.close()},close(){this.$emit("update:modelValue",!1)}}};var Y=Object.assign(N,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),i=(0,l.up)("el-upload"),n=(0,l.up)("el-col"),o=(0,l.up)("el-table-column"),r=(0,l.up)("el-table"),s=(0,l.up)("el-row"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"上传图片"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"avatar-uploader up-box",action:"/upload",drag:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},{default:(0,l.w5)((()=>[e.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,src:e.imageUrl,class:"avatar"},null,8,H)):((0,l.wg)(),(0,l.j4)(a,{key:1,class:"avatar-uploader-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1}))])),_:1},8,["on-success","before-upload"])])),_:1}),(0,l.Wm)(n,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"up-box",data:e.fileprops,border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{prop:"name",label:"属性"}),(0,l.Wm)(o,{prop:"value",label:"值"})])),_:1},8,["data"])])),_:1})])),_:1}),(0,l._)("div",null,[(0,l.Wm)(m,{type:"success",onClick:e.save},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1},8,["onClick"]),(0,l.Wm)(m,{type:"default",onClick:e.cancel},{default:(0,l.w5)((()=>[(0,l.Uk)(" 取消 ")])),_:1},8,["onClick"])])])),_:1})}}});const q=(0,g.Z)(Y,[["__scopeId","data-v-7061dd8c"]]);var G=q,J={name:"settings-mediae-index",components:{MyToolbar:w,MyTable:F,MyUpImageDialog:G,MyPager:y},data(){return{displayUploadDialog:!1}},methods:{fetch(){this.$store.dispatch("media/fetch",{all:1})},upload(){this.displayUploadDialog=!0},importPresets(){this.$store.dispatch("media/import_presets",{})},handleAction(e){let t=e.name;"refresh"==t?this.fetch():"import-presets"==t?this.importPresets():"insert"==t&&this.upload()}},mounted(){this.fetch()}};const K=(0,g.Z)(J,[["render",s],["__scopeId","data-v-be2d93de"]]);var Q=K,X={name:"SettingsMediaeView",components:{ClientViewIndex:Q}};const ee=(0,g.Z)(X,[["render",i]]);var te=ee}}]);
//# sourceMappingURL=365.37c02d14.js.map
"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[884],{9698:function(e,t,a){a.d(t,{Z:function(){return c}});var l=a(3396),i=a(7139),n=a(9242);const o={class:"utils-batch-tool-bar"},s={class:"the-count-box"};function r(e,t,a,r,d,u){return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("span",null,(0,i.zw)(a.title),1),(0,l._)("span",s,(0,i.zw)(u.count)+" 项 ",1),(0,l.WI)(e.$slots,"default",{},void 0,!0)],512)),[[n.F8,!u.hide]])}var d={name:"utils-batch-tool-bar",computed:{items(){let e=this.modelValue;return null==e&&(e=[]),e},count(){let e=this.items.length;return null==e?0:e},hide(){return!!this.hideEmpty&&this.count<=0}},props:{modelValue:Array,title:String,hideEmpty:Boolean}},u=a(89);const m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-5c44dc71"]]);var c=m},4031:function(e,t,a){a.d(t,{Z:function(){return m}});var l=a(3396),i=a(7139);const n={class:"icon-parent"},o=["src","title"];function s(e,t,a,s,r,d){return(0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("img",{class:"icon-image",src:a.src,title:a.title,style:(0,i.j5)(d.imageStyle)},null,12,o)])}var r={computed:{imageStyle(){let e=this.size+"px";return{maxWidth:e,maxHeight:e}}},props:{src:String,size:Number,title:String}},d=a(89);const u=(0,d.Z)(r,[["render",s],["__scopeId","data-v-5e686d6f"]]);var m=u},8884:function(e,t,a){a.r(t),a.d(t,{default:function(){return ee}});var l=a(3396);function i(e,t,a,i,n,o){const s=(0,l.up)("ClientViewIndex"),r=(0,l.up)("AdminFrame");return(0,l.wg)(),(0,l.j4)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s)])),_:1})}const n=e=>((0,l.dD)("data-v-be2d93de"),e=e(),(0,l.Cn)(),e),o={class:"settings-mediae-index-page"},s=n((()=>(0,l._)("h1",null,"媒体文件",-1)));function r(e,t,a,i,n,r){const d=(0,l.up)("MyToolbar"),u=(0,l.up)("MyPager"),m=(0,l.up)("MyTable"),c=(0,l.up)("MyUpImageDialog");return(0,l.wg)(),(0,l.iD)("div",o,[s,(0,l.Wm)(d,{onAction:r.handleAction},null,8,["onAction"]),(0,l.Wm)(u,{class:"settings-mediae-index-pager"}),(0,l.Wm)(m),(0,l.Wm)(c,{modelValue:n.displayUploadDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>n.displayUploadDialog=e)},null,8,["modelValue"])])}var d=a(4870),u=a(2748);const m={class:"toolbar"},c={name:"settings-mediae-toolbar",methods:{fire(e){let t={name:e};this.$emit("action",t)},insert(){this.fire("insert")},refresh(){this.fire("refresh")},importPresets(){this.fire("import-presets")}}};var p=Object.assign(c,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),i=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",m,[(0,l.Wm)(i,{type:"default",onClick:e.refresh},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.hYj))])),_:1}),(0,l.Uk)(" 刷新 ")])),_:1},8,["onClick"]),(0,l.Wm)(i,{type:"default",onClick:e.insert},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1}),(0,l.Uk)(" 添加 ")])),_:1},8,["onClick"]),(0,l.Wm)(i,{type:"default",onClick:e.importPresets},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37)),(0,l.Uk)(),(0,l.Wm)((0,d.SU)(u.v37))])),_:1}),(0,l.Uk)(" 导入预置资源 ")])),_:1},8,["onClick"])])}}}),h=a(89);const g=(0,h.Z)(p,[["__scopeId","data-v-0ce938ae"]]);var f=g;function w(e,t,a,i,n,o){const s=(0,l.up)("el-pagination");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(s,{"current-page":n.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>n.currentPage=e),"page-size":n.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>n.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:n.background,layout:"total, sizes, prev, pager, next",total:o.theCountItemsTotal,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var v={name:"settings-mediae-pager",computed:{theCountItemsTotal(){return this.$store.getters["media/total"]}},data(){return{currentPage:1,pageSize:10,background:!0}},methods:{handleSizeChange(e){let t=e,a=0;this.$store.commit("media/update",{index:a,size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit("media/update",{index:t})}}};const _=(0,h.Z)(v,[["render",w]]);var b=_;const k=["src"];function y(e,t,a,i,n,o){const s=(0,l.up)("el-table-column"),r=(0,l.up)("el-button"),d=(0,l.up)("el-table"),u=(0,l.up)("MyBatch"),m=(0,l.up)("MyItemDetailDialog");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(d,{data:o.items,onSelectionChange:o.handleSelectionChange},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"selection"}),(0,l.Wm)(s,{prop:"url",label:"",width:"90"},{default:(0,l.w5)((e=>[(0,l._)("img",{class:"media-item-image",src:e.row.url},null,8,k)])),_:1}),(0,l.Wm)(s,{prop:"label",label:"名称",sortable:""}),(0,l.Wm)(s,{prop:"content_type",label:"类型",sortable:""}),(0,l.Wm)(s,{prop:"size",label:"大小",sortable:""}),(0,l.Wm)(s,{label:"操作",width:"170px"},{default:(0,l.w5)((e=>[(0,l.Wm)(r,{link:"",type:"primary",onClick:t=>o.handleClickItemDetail(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("详情")])),_:2},1032,["onClick"]),(0,l.Wm)(r,{link:"",type:"danger",onClick:t=>o.handleClickRemoveItem(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,l.Wm)(u,{modelValue:n.selectedItems,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedItems=e)},null,8,["modelValue"]),(0,l.Wm)(m,{modelValue:n.displayDetailDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>n.displayDetailDialog=e),target:e.theDetailDialogItem},null,8,["modelValue","target"])])}var W=a(2655);const C={style:{"margin-top":"10px"}};function U(e,t,a,i,n,o){const s=(0,l.up)("el-button"),r=(0,l.up)("BatchToolBar");return(0,l.wg)(),(0,l.iD)("div",C,[(0,l.Wm)(r,{modelValue:o.items,"onUpdate:modelValue":t[0]||(t[0]=e=>o.items=e),title:"批处理",hideEmpty:!0},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"danger",onClick:o.handleDelete},{default:(0,l.w5)((()=>[(0,l.Uk)(" 删除 ")])),_:1},8,["onClick"]),(0,l.Wm)(s,{type:"primary",onClick:o.handlePutToBuffer},{default:(0,l.w5)((()=>[(0,l.Uk)(" 存入缓冲区 ")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])}var D=a(9698),z={name:"settings-intent-templates-batch",components:{BatchToolBar:D.Z},computed:{items(){return this.modelValue}},methods:{handleDelete(){let e=this.items;this.$store.dispatch("media/remove",{items:e})},handlePutToBuffer(){let e="mediae",t={};t[e]=this.items,this.$store.dispatch("jsonbuffer/put",{vo:t})}},props:{modelValue:Array}};const I=(0,h.Z)(z,[["render",U]]);var S=I,x=a(7139);const V={class:"info-parent"};function T(e,t,a,i,n,o){const s=(0,l.up)("MyIcon"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),u=(0,l.up)("ElButton"),m=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(m,{title:"媒体文件详情","align-center":"",width:"800px"},{default:(0,l.w5)((()=>[(0,l._)("div",V,[(0,l.Wm)(s,{class:"info-icon",src:o.item.url,size:99,title:""},null,8,["src"]),(0,l.Wm)(d,{class:"info-form","label-width":"128px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.name),1)])),_:1}),(0,l.Wm)(r,{label:"类型"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.content_type),1)])),_:1}),(0,l.Wm)(r,{label:"显示名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.label),1)])),_:1}),(0,l.Wm)(r,{label:"ID / UUID"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.id)+" / "+(0,x.zw)(o.item.uuid),1)])),_:1}),(0,l.Wm)(r,{label:"SHA-256"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.sha256sum),1)])),_:1}),(0,l.Wm)(r,{label:"大小"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.item.size),1)])),_:1}),(0,l.Wm)(r,{label:"创建时间"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.formatTime(o.item.created_at)),1)])),_:1}),(0,l.Wm)(r,{label:"修改时间"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,x.zw)(o.formatTime(o.item.updated_at)),1)])),_:1})])),_:1})]),(0,l._)("div",null,[(0,l.Wm)(u,{type:"default",onClick:o.close},{default:(0,l.w5)((()=>[(0,l.Uk)("关闭")])),_:1},8,["onClick"])])])),_:1})}var M=a(6465),Z=a(4031),B=a(9466),P={name:"settings-local-repository-item-detail-dialog",components:{ElButton:M.mi,MyIcon:Z.Z},computed:{item(){return this.target}},methods:{formatTime(e){return B.Z.StringifyTimestamp(e,"datetime")},close(){this.$emit("update:modelValue",!1)}},props:{target:Object}};const $=(0,h.Z)(P,[["render",T],["__scopeId","data-v-985fcc6c"]]);var A=$,j={name:"settings-mediae-table",components:{MyBatch:S,MyItemDetailDialog:A},computed:{items(){return this.$store.getters["media/list"]}},data(){return{selectedItems:[],theDetailDialogTarget:{},displayDetailDialog:!1}},methods:{handleClickItemDetail(){},handleClickRemoveItem(e){let t="移除媒体文件",a="确定要移除 ["+e.name+"] 这个媒体文件吗？",l="注意：移除该文件可能会导致引用它的内容显示不正常！";W.T.confirm(a+l,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},handleClickItemDetail(e){this.theDetailDialogItem=e,this.displayDetailDialog=!0},removeItem(e){this.$store.dispatch("media/remove",{item:e})},handleSelectionChange(e){this.selectedItems=e}}};const E=(0,h.Z)(j,[["render",y],["__scopeId","data-v-0699b50c"]]);var F=E,O=(a(7658),a(7178));const R=["src"];function H(){}const L={name:"update-up-dialog",data(){return{imageUrl:"",vo:{},item:{},fileprops:[{name:"",value:""}]}},methods:{handleAvatarSuccess(e,t){H(e);let a=e,l=a.mediae[0];this.vo=a,this.item=l,this.fileprops=this.makeFileProps(l),this.imageUrl=URL.createObjectURL(t.raw)},makeFileProps(e){const t={name:"文件名",size:"大小",content_type:"类型",sha256sum:"SHA-256"};let a=[];for(var l in t){let i=t[l],n=e[l];a.push({name:i,value:n})}return a},beforeAvatarUpload(e){return this.acceptType(e.type)?!(e.size/1024/1024>2)||(O.z8.error("文件太大了，最多支持 2MB!"),!1):(O.z8.error("不支持的文件格式!"),console.warn("不支持的文件格式: "+e.type),!1)},acceptType(e){const t=["image/jpeg","image/png","image/gif","image/svg","image/webp","image/svg+xml"];for(var a in t){let l=t[a];if(l==e)return!0}return!1},save(){let e=this.item;this.$store.dispatch("media/insert",{item:e}).then((()=>{this.close()}))},cancel(){this.close()},close(){this.$emit("update:modelValue",!1)}}};var N=Object.assign(L,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),i=(0,l.up)("el-upload"),n=(0,l.up)("el-col"),o=(0,l.up)("el-table-column"),s=(0,l.up)("el-table"),r=(0,l.up)("el-row"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"上传图片"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"avatar-uploader up-box",action:"/upload",drag:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},{default:(0,l.w5)((()=>[e.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,src:e.imageUrl,class:"avatar"},null,8,R)):((0,l.wg)(),(0,l.j4)(a,{key:1,class:"avatar-uploader-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1}))])),_:1},8,["on-success","before-upload"])])),_:1}),(0,l.Wm)(n,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"up-box",data:e.fileprops,border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{prop:"name",label:"属性"}),(0,l.Wm)(o,{prop:"value",label:"值"})])),_:1},8,["data"])])),_:1})])),_:1}),(0,l._)("div",null,[(0,l.Wm)(m,{type:"success",onClick:e.save},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1},8,["onClick"]),(0,l.Wm)(m,{type:"default",onClick:e.cancel},{default:(0,l.w5)((()=>[(0,l.Uk)(" 取消 ")])),_:1},8,["onClick"])])])),_:1})}}});const Y=(0,h.Z)(N,[["__scopeId","data-v-7061dd8c"]]);var q=Y,G={name:"settings-mediae-index",components:{MyToolbar:f,MyTable:F,MyUpImageDialog:q,MyPager:b},data(){return{displayUploadDialog:!1}},methods:{fetch(){this.$store.dispatch("media/fetch",{all:1})},upload(){this.displayUploadDialog=!0},importPresets(){this.$store.dispatch("media/import_presets",{})},handleAction(e){let t=e.name;"refresh"==t?this.fetch():"import-presets"==t?this.importPresets():"insert"==t&&this.upload()}},mounted(){this.fetch()}};const J=(0,h.Z)(G,[["render",r],["__scopeId","data-v-be2d93de"]]);var K=J,Q={name:"SettingsMediaeView",components:{ClientViewIndex:K}};const X=(0,h.Z)(Q,[["render",i]]);var ee=X}}]);
//# sourceMappingURL=884.bc795101.js.map
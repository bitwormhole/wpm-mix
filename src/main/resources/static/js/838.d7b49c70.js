"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[838],{1838:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var n=a(3396);function l(e,t,a,l,i,s){const r=(0,n.up)("ClientViewIndex"),d=(0,n.up)("AdminFrame");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r)])),_:1})}const i=e=>((0,n.dD)("data-v-6a02b02c"),e=e(),(0,n.Cn)(),e),s={class:"settings-index-page"},r=i((()=>(0,n._)("h1",null,"插件",-1)));function d(e,t,a,l,i,d){const o=(0,n.up)("MyToolbar"),u=(0,n.up)("MySearch"),c=(0,n.up)("MyPager"),m=(0,n.up)("MyTable"),p=(0,n.up)("MyEdit");return(0,n.wg)(),(0,n.iD)("div",s,[r,(0,n.Wm)(o,{onAction:d.handleAction},null,8,["onAction"]),(0,n.Wm)(u,{class:"search-box"}),(0,n.Wm)(c,{class:"pager-box"}),(0,n.Wm)(m,{onAction:d.handleAction},null,8,["onAction"]),(0,n.Wm)(p,{method:"POST",enabled:i.theAddEnabled,"onUpdate:enabled":t[0]||(t[0]=e=>i.theAddEnabled=e),item:i.theAddItem,"onUpdate:item":t[1]||(t[1]=e=>i.theAddItem=e)},null,8,["enabled","item"]),(0,n.Wm)(p,{method:"PUT",enabled:i.theEditEnabled,"onUpdate:enabled":t[2]||(t[2]=e=>i.theEditEnabled=e),item:i.theEditItem,"onUpdate:item":t[3]||(t[3]=e=>i.theEditItem=e)},null,8,["enabled","item"])])}var o=a(7139);const u=["title"];function c(e,t,a,l,i,s){const r=(0,n.up)("el-button"),d=(0,n.up)("el-table-column"),c=(0,n.up)("MyInstallingState"),m=(0,n.up)("el-table"),p=(0,n.up)("MyItemDetailDialog");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(m,{data:s.items},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{prop:"name",label:"名称"},{default:(0,n.w5)((e=>[(0,n.Wm)(r,{link:"",type:"primary",onClick:t=>s.openItemDetail(e.row)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),(0,n.Wm)(d,{prop:"title",label:"标题"},{default:(0,n.w5)((e=>[(0,n._)("span",{title:e.row.description},(0,o.zw)(e.row.title),9,u)])),_:1}),(0,n.Wm)(d,{prop:"version",label:"版本"}),(0,n.Wm)(d,{prop:"state",label:"状态"},{default:(0,n.w5)((e=>[(0,n.Wm)(c,{modelValue:e.row.state},null,8,["modelValue"])])),_:1}),(0,n.Wm)(d,{label:"操作",width:"170px"},{default:(0,n.w5)((e=>[(0,n.Wm)(r,{link:"",type:"primary",onClick:t=>s.openItemDetail(e.row)},{default:(0,n.w5)((()=>[(0,n.Uk)("详情")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,n.Wm)(p,{class:"plug-in-detail-dialog",modelValue:i.displayDetailDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>i.displayDetailDialog=e),target:i.theDetailDialogTarget,onAction:s.handleAction},null,8,["modelValue","target","onAction"])])}var m=a(9242);const p={class:"box-area-1"},h={class:"item-icon-box"},g=["src"],f={class:"box-area-2"},b={class:"box-area-3"};function w(e,t,a,l,i,s){const r=(0,n.up)("el-form-item"),d=(0,n.up)("MyInstallingState"),u=(0,n.up)("el-form"),c=(0,n.up)("el-divider"),w=(0,n.up)("el-button"),k=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.j4)(k,{title:s.dialogTitle,onOpen:s.handleOpen,"align-center":"",width:"640px"},{default:(0,n.w5)((()=>[(0,n._)("div",p,[(0,n._)("div",h,[(0,n._)("img",{class:"item-icon-image",src:i.item.icon},null,8,g),(0,n._)("h2",null,(0,o.zw)(i.item.name),1),(0,n._)("h4",null,(0,o.zw)(i.item.title),1)]),(0,n._)("div",null,[(0,n.Wm)(u,{"label-width":"100"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{label:"版本"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(i.packVersion),1)])),_:1}),(0,n.Wm)(r,{label:"大小"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(i.packSize),1)])),_:1}),(0,n.Wm)(r,{label:"适用平台"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(i.packOS)+" / "+(0,o.zw)(i.packArch),1)])),_:1}),(0,n.Wm)(r,{label:"发布时间"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(i.packDate),1)])),_:1}),(0,n.Wm)(r,{label:"状态"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{modelValue:i.item.state},null,8,["modelValue"])])),_:1})])),_:1})])]),(0,n._)("div",f,[(0,n.Wm)(c),(0,n._)("p",null,(0,o.zw)(i.item.description),1),(0,n.Wm)(c)]),(0,n._)("div",b,[(0,n.wy)((0,n.Wm)(w,{type:"success",onClick:s.install,disabled:!s.canInstall},{default:(0,n.w5)((()=>[(0,n.Uk)(" 安装 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canInstall]]),(0,n.wy)((0,n.Wm)(w,{type:"default",link:"",onClick:s.upgrade,disabled:!s.canUpgrade},{default:(0,n.w5)((()=>[(0,n.Uk)(" 升级 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canUpgrade]]),(0,n.wy)((0,n.Wm)(w,{type:"default",link:"",onClick:s.reinstall,disabled:!s.canReInstall},{default:(0,n.w5)((()=>[(0,n.Uk)(" 重新安装 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canReInstall]]),(0,n.wy)((0,n.Wm)(w,{type:"danger",onClick:s.uninstall,disabled:!s.canUninstall},{default:(0,n.w5)((()=>[(0,n.Uk)(" 卸载 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canUninstall]])])])),_:1},8,["title","onOpen"])}var k=a(4870),_=a(2748);const v={na:"不可用",INSTALLED:"已安装",NEWVERSION:"可升级",AVAILABLE:"未安装"},y={name:"settings-plug-ins-installing-state",computed:{text(){let e=this.modelValue,t=v[e];return null==t&&(t=e),t},canUpgrade(){return"NEWVERSION"==this.modelValue},installed(){return"INSTALLED"==this.modelValue}},props:{modelValue:String}};var I=Object.assign(y,{setup(e){return(e,t)=>{const a=(0,n.up)("el-icon");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.wy)((0,n.Wm)(a,{class:"icon-info"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,k.SU)(_.cEj))])),_:1},512),[[m.F8,e.canUpgrade]]),(0,n.Uk)(" "+(0,o.zw)(e.text)+" ",1),(0,n.wy)((0,n.Wm)(a,{class:"icon-success"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,k.SU)(_.c5o))])),_:1},512),[[m.F8,e.installed]])])}}}),S=a(89);const W=(0,S.Z)(I,[["__scopeId","data-v-1ccceb51"]]);var C=W,D=a(9466),A=a(2875);function U(){this.latest=null,this.current=null}U.prototype={add(e){e.installed&&(this.current=e),this.latest=e},stringifyItems(e,t){let a=this.current,n=this.latest,l=[a,n],i="",s="",r=null;for(var d in l){let a=l[d];if(null==a)continue;let n=a[e];if(null==n)continue;if(a.id==r)break;r=a.id;let o=t(n);i=i+s+o,s=" ==> "}return i},getVersion(){return this.stringifyItems("version",(e=>e))},getSize(){return this.stringifyItems("size",(e=>A.Z.StringifySize(e)))},getDate(){return this.stringifyItems("release_at",(e=>D.Z.StringifyTimestamp(e)))},getArch(){return this.stringifyItems("arch",(e=>e))},getOS(){return this.stringifyItems("os",(e=>e))}};var z={name:"settings-plug-ins-item-detail-dialog",components:{MyInstallingState:C},computed:{dialogTitle(){return"插件详情"},canInstall(){return!this.item.installed},canUninstall(){return this.item.installed},canReInstall(){return this.item.installed},canUpgrade(){return"NEWVERSION"==this.item.state},item(){return this.target}},data(){return{item:{},packVersion:"",packSize:"",packDate:"",packOS:"",packArch:""}},methods:{install(){this.fireAction("install")},reinstall(){this.fireAction("re-install")},uninstall(){this.fireAction("uninstall")},upgrade(){this.fireAction("upgrade")},fireAction(e){let t=this.target,a={name:e,target:t};this.$emit("action",a),this.close()},prepareItem(e){let t=JSON.stringify(e),a=JSON.parse(t),n=a.packages,l=new U;if(null!=n)for(var i in n)l.add(n[i]);return this.packVersion=l.getVersion(),this.packSize=l.getSize(),this.packDate=l.getDate(),this.packArch=l.getArch(),this.packOS=l.getOS(),a},handleOpen(){let e=this.target;null!=e&&(this.item=this.prepareItem(e))},close(){this.$emit("update:modelValue",!1)}},props:{target:Object},watch:{}};const E=(0,S.Z)(z,[["render",w],["__scopeId","data-v-28f59426"]]);var V=E;var x={name:"settings-plug-ins-table",components:{MyItemDetailDialog:V,MyInstallingState:C},computed:{items(){return this.$store.getters["soft_set/list"]}},data(){return{theDetailDialogTarget:{},displayDetailDialog:!1}},methods:{openItemDetail(e){this.theDetailDialogTarget=e,this.displayDetailDialog=!0},handleAction(e){this.$emit("action",e)}},mounted(){}};const O=(0,S.Z)(x,[["render",c],["__scopeId","data-v-f8f70aba"]]);var M=O;function T(e,t,a,l,i,s){const r=(0,n.up)("el-pagination");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(r,{"current-page":s.currentPage,"page-size":s.pageSize,"page-sizes":[5,10,20,50,100,200,500],background:i.background,layout:"total, sizes, prev, pager, next",total:s.theCountItemsTotal,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}const $="soft_set/";var N={name:"settings-plug-ins-table",computed:{currentPage(){return this.$store.getters[$+"current_page"]},pageSize(){return this.$store.getters[$+"page_size"]},theCountItemsTotal(){return this.$store.getters[$+"total"]}},data(){return{background:!1}},methods:{handleSizeChange(e){let t=e,a=0;this.$store.commit($+"update",{index:a,size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit($+"update",{index:t})}},mounted(){}};const Z=(0,S.Z)(N,[["render",T]]);var F=Z;function P(e,t,a,l,i,s){return(0,n.wg)(),(0,n.iD)("div")}var L={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{},mounted(){}};const R=(0,S.Z)(L,[["render",P]]);var j=R;function J(e,t,a,l,i,s){const r=(0,n.up)("el-button");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(r,{onClick:s.refresh},{default:(0,n.w5)((()=>[(0,n.Uk)(" 刷新 ")])),_:1},8,["onClick"]),(0,n.Wm)(r,{onClick:s.handleClickUpdate},{default:(0,n.w5)((()=>[(0,n.Uk)(" 更新插件列表 ")])),_:1},8,["onClick"])])}var B={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{fetch(){this.$store.dispatch("soft_set/fetch")},refresh(){this.fetch()},handleClickUpdate(){this.$store.dispatch("soft_pack/update_sources")}},mounted(){this.fetch()}};const q=(0,S.Z)(B,[["render",J]]);var G=q;function H(e,t,a,l,i,s){return(0,n.wg)(),(0,n.iD)("div")}var K={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{},mounted(){}};const Q=(0,S.Z)(K,[["render",H]]);var X=Q,Y=a(4775),ee={name:"settings-executables",components:{MyTable:M,MyPager:F,MySearch:j,MyToolbar:G,MyEdit:X},data(){return{theAddItem:{},theAddEnabled:!1,theEditItem:{},theEditEnabled:!1}},methods:{handleAction(e){let t=e.name;"edit"==t?this.edit(e.item):"add"==t?this.add():"install"==t?this.installSet(e.target):"uninstall"==t?this.uninstallSet(e.target):"re-install"==t?this.reInstallSet(e.target):"upgrade"==t&&this.upgradeSet(e.target)},add(){this.theAddItem={icon:"/image/exe-icons/default.png"},this.theAddEnabled=!0},installSet(e){let t="正在安装...",a={fullscreen:!0,text:t};const n=Y.kN.service(a);this.$store.dispatch("soft_set/install",{item:e}).finally((()=>{n.close()}))},uninstallSet(e){let t="正在卸载...",a={fullscreen:!0,text:t};const n=Y.kN.service(a);this.$store.dispatch("soft_set/uninstall",{item:e}).finally((()=>{n.close()}))},reInstallSet(e){let t="正在重新安装...",a={fullscreen:!0,text:t};const n=Y.kN.service(a);this.$store.dispatch("soft_set/reinstall",{item:e}).finally((()=>{n.close()}))},upgradeSet(e){let t={fullscreen:!0,text:"正在升级..."};const a=Y.kN.service(t);this.$store.dispatch("soft_set/upgrade",{item:e}).finally((()=>{a.close()}))},edit(e){this.theEditItem=e,this.theEditEnabled=!0}}};const te=(0,S.Z)(ee,[["render",d],["__scopeId","data-v-6a02b02c"]]);var ae=te,ne={name:"SettingsPlugInsView",components:{ClientViewIndex:ae}};const le=(0,S.Z)(ne,[["render",l]]);var ie=le}}]);
//# sourceMappingURL=838.d7b49c70.js.map
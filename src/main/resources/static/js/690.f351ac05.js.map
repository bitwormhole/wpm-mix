{"version":3,"file":"js/690.f351ac05.js","mappings":"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","sources":["webpack://wpm-station-vue/./src/js/time.js","webpack://wpm-station-vue/./src/components/filebrowser/dialog-open.vue","webpack://wpm-station-vue/./src/components/filebrowser/path-bar.vue","webpack://wpm-station-vue/./src/components/filebrowser/path-bar.vue?533f","webpack://wpm-station-vue/./src/components/filebrowser/view-detail-table.vue","webpack://wpm-station-vue/./src/js/bytes.js","webpack://wpm-station-vue/./src/components/filebrowser/view-detail-table.vue?6572","webpack://wpm-station-vue/./src/components/filebrowser/dialog-common.vue","webpack://wpm-station-vue/./src/components/filebrowser/dialog-common.vue?2bd0","webpack://wpm-station-vue/./src/components/filebrowser/dialog-open.vue?55d8"],"sourcesContent":["\n\nfunction stringifyNumWithWidth(num, width) {\n    let str = num + ''\n    if (num < 0) {\n        return str\n    }\n    if (width == null) {\n        return str\n    }\n    if (width < 2) {\n        return str\n    }\n    for (; str.length < width;) {\n        str = '0' + str\n    }\n    return str\n}\n\n\n////////////////////////////////////////////////////////////////////////////////\n// public\n\n/**\n  文本化时间戳。ms 表示基于1970-01-01的毫秒数\n  fmt 的取值可以是 [\"date\"|\"time\"|\"datetime\"] 其中之一。\n*/\nfunction StringifyTimestamp(ms, fmt) {\n    if (ms == null) { ms = 0 }\n    let t = new Date()\n    t.setTime(ms)\n    return StringifyDate(t, fmt)\n}\n\n/**\n  文本化时间戳。date 是一个 javascript Date 对象。\n  fmt 的取值可以是 [\"date\"|\"time\"|\"datetime\"] 其中之一。\n*/\nfunction StringifyDate(date, fmt) {\n\n    let t = date;\n    if (t == null) {\n        t = new Date();\n        t.setTime(0)\n    }\n\n    let YY = t.getFullYear()\n    let MM = t.getMonth() + 1\n    let DD = t.getDate()\n    let hh = t.getHours()\n    let mm = t.getMinutes()\n    let ss = t.getSeconds()\n\n    let sep = ''\n    let ymd = ''\n    let hms = ''\n    let has_ymd = false\n    let has_hms = false\n\n    if (fmt == \"date\") {\n        has_ymd = true\n    } else if (fmt == \"time\") {\n        has_hms = true\n    } else {\n        // date-and-time\n        has_ymd = true\n        has_hms = true\n        sep = \"  \"\n    }\n\n    if (has_ymd) {\n        let s1 = '' + YY\n        let s2 = stringifyNumWithWidth(MM, 2)\n        let s3 = stringifyNumWithWidth(DD, 2)\n        ymd = s1 + '-' + s2 + '-' + s3\n    }\n\n    if (has_hms) {\n        let s1 = stringifyNumWithWidth(hh, 2)\n        let s2 = stringifyNumWithWidth(mm, 2)\n        let s3 = stringifyNumWithWidth(ss, 2)\n        hms = s1 + ':' + s2 + ':' + s3\n    }\n\n    return ymd + sep + hms\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default {\n    name: \"TimeJS\",\n    StringifyTimestamp,\n    StringifyDate,\n}\n","<template>\n  <div>\n    <MyDialogCommon\n      :modelValue=\"modelValue\"\n      bank=\"dialog_open\"\n      :multipleSelection=\"multipleSelection\"\n      @update:modelValue=\"updateModelValue\"\n      @open-file=\"handleOpenFile\"\n    />\n  </div>\n</template>\n\n<script>\nimport MyDialogCommon from \"./dialog-common.vue\";\n\nexport default {\n  name: \"filebrowser-dialog-open\",\n  components: { MyDialogCommon },\n\n  methods: {\n    updateModelValue(p) {\n      this.$emit(\"update:modelValue\", p);\n    },\n\n    handleOpenFile(files) {\n      this.$emit(\"open-file\", files);\n    },\n  },\n\n  props: {\n    modelValue: Boolean,\n    multipleSelection: Boolean,\n  },\n};\n</script>\n\n<style scoped>\n</style>\n","<template>\n  <div>\n    <div class=\"mode-elements\" v-show=\"mode.current == mode.elements\">\n      <el-breadcrumb class=\"mode-elements-bread\" :separator-icon=\"ArrowRight\">\n        <el-breadcrumb-item>\n          <el-button\n            class=\"path-element\"\n            link\n            type=\"primary\"\n            @click=\"handleClickPathRoot\"\n          >\n            根\n          </el-button>\n        </el-breadcrumb-item>\n\n        <el-breadcrumb-item v-for=\"item in items\" :key=\"item.id\">\n          <el-button\n            class=\"path-element\"\n            link\n            type=\"primary\"\n            :title=\"item.path\"\n            @click=\"handleClickPathItem(item)\"\n          >\n            {{ item.name }}\n          </el-button>\n        </el-breadcrumb-item>\n      </el-breadcrumb>\n\n      <el-button link @click=\"handleClickEdit\" title=\"编辑路径\">\n        <el-icon> <Edit /> </el-icon>\n      </el-button>\n    </div>\n\n    <div class=\"mode-input\" v-show=\"mode.current == mode.edit\">\n      <el-input v-model=\"pathText\" placeholder=\"请输入要查询的路径\">\n        <template #prepend>\n          <el-button @click=\"handleClickCancel\" title=\"取消\">\n            <el-icon> <CloseBold /> </el-icon>\n          </el-button>\n        </template>\n\n        <template #append>\n          <el-button @click=\"handleClickGo\" title=\"查询\">\n            <el-icon> <Right /> </el-icon>\n          </el-button>\n        </template>\n      </el-input>\n    </div>\n  </div>\n</template>\n\n\n<script setup>\nimport { Edit, Right, CloseBold, ArrowRight } from \"@element-plus/icons-vue\";\n</script>\n\n\n<script>\n// import xxx from ''\n\nexport default {\n  name: \"filebrowser-path-bar\",\n\n  computed: {\n    items() {\n      return this.makeItems(this.elements);\n    },\n\n    elements() {\n      return this.$store.getters[\"files/GetPathElements\"](this.bank);\n    },\n  },\n\n  data() {\n    return {\n      mode: {\n        current: 2,\n        edit: 1,\n        elements: 2,\n      },\n      pathText: \"\",\n    };\n  },\n\n  methods: {\n    handleClickEdit() {\n      let bank = this.bank;\n      let path = this.$store.getters[\"files/GetPathString\"](bank);\n      if (path == null) {\n        path = \"\";\n      }\n      this.pathText = path;\n      this.mode.current = this.mode.edit;\n    },\n\n    handleClickGo() {\n      this.mode.current = this.mode.elements;\n      this.navTo(this.pathText);\n    },\n\n    handleClickCancel() {\n      this.mode.current = this.mode.elements;\n    },\n\n    handleClickPathItem(item) {\n      let path = item.path;\n      this.navTo(path);\n    },\n\n    handleClickPathRoot() {\n      this.navTo(\"/\");\n    },\n\n    makeItems(src) {\n      let dst = [];\n      let dir = \"\";\n      for (var i in src) {\n        let name = src[i];\n        let item = this.makeItem(name, dir);\n        dst.push(item);\n        dir = item.path;\n      }\n      return dst;\n    },\n\n    makeItem(name, parent) {\n      let item = {};\n      item.path = parent + \"/\" + name;\n      item.name = name;\n      return item;\n    },\n\n    navTo(path) {\n      let bank = this.bank;\n      this.$store.dispatch(\"files/fetch\", { bank, path });\n    },\n  },\n\n  props: { bank: String },\n};\n</script>\n\n<style scoped>\n.mode-elements {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 10px;\n  padding-right: 10px;\n  border-radius: 3px;\n  border-style: solid;\n  border-width: 1px;\n  border-color: rgba(128, 128, 128, 0);\n}\n\n.mode-elements:hover {\n  background-color: rgb(233, 232, 232);\n  border-color: rgb(222, 222, 222);\n}\n\n.mode-elements-bread {\n  flex-grow: 1;\n}\n\n.path-element {\n  color: rgb(68, 68, 68);\n}\n\n.path-element:hover {\n  color: rgb(48, 155, 255);\n}\n</style>\n","import script from \"./path-bar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./path-bar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./path-bar.vue?vue&type=style&index=0&id=44e24e86&scoped=true&lang=css\"\n\nimport exportComponent from \"F:\\\\home\\\\xukun\\\\git.bitwormhole\\\\wpm-ui\\\\vuejs\\\\wpm-station-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-44e24e86\"]])\n\nexport default __exports__","<template>\n  <div>\n    <el-table\n      :data=\"items\"\n      ref=\"theTable\"\n      highlight-current-row\n      @selection-change=\"handleSelectionChange\"\n      @current-change=\"handleCurrentChange\"\n    >\n      <el-table-column :type=\"tableColumnType\"></el-table-column>\n\n      <el-table-column prop=\"name\" label=\"名称\" sortable>\n        <template #default=\"scope\">\n          <el-button\n            link\n            type=\"primary\"\n            @click=\"handleClickItemName(scope.row)\"\n          >\n            {{ scope.row.name }}\n          </el-button>\n        </template>\n      </el-table-column>\n\n      <el-table-column\n        prop=\"content_type\"\n        label=\"类型\"\n        sortable\n      ></el-table-column>\n\n      <el-table-column\n        prop=\"updated_at\"\n        label=\"修改时间\"\n        :formatter=\"formatTimestamp\"\n        sortable\n      ></el-table-column>\n\n      <el-table-column\n        prop=\"size\"\n        label=\"大小\"\n        :formatter=\"formatByteSize\"\n        sortable\n      ></el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nimport TimeJS from \"./../../js/time.js\";\nimport ByteJS from \"./../../js/bytes.js\";\n\nfunction nop() {}\n\nexport default {\n  name: \"filebrowser-view-detail-table\",\n\n  computed: {\n    items() {\n      return this.$store.getters[\"files/GetItems\"](this.bank);\n    },\n\n    tableColumnType() {\n      return this.multipleSelection ? \"selection\" : \"index\";\n      // return \"selection\";\n    },\n  },\n\n  data() {\n    return {\n      selection1: {},\n      selectionN: [],\n    };\n  },\n\n  methods: {\n    handleClickItemName(item) {\n      if (item.is_dir) {\n        this.openDir(item);\n      }\n    },\n\n    openDir(item) {\n      let bank = this.bank;\n      let href = item.name;\n      this.$store.dispatch(\"files/fetch\", { bank, href });\n    },\n\n    getFieldByName(name, item) {\n      if (name == null || item == null) {\n        return \"\";\n      }\n      return item[name];\n    },\n\n    handleCurrentChange(currentRow /* , oldCurrentRow */) {\n      // let n2 = this.getFieldByName(\"name\", currentRow);\n      // let n1 = this.getFieldByName(\"name\", oldCurrentRow);\n      // console.warn(\"current-change old:\" + n1 + \" current:\" + n2);\n      ////////\n      if (currentRow != null) {\n        this.selection1 = currentRow;\n      }\n      this.fireSelectionChange();\n    },\n\n    handleSelectionChange() {\n      let rows = this.$refs.theTable.getSelectionRows();\n      // let cnt = rows.length;\n      // console.warn(\"selection.count=\" + cnt);\n      ////////\n      if (rows != null) {\n        this.selectionN = rows;\n      }\n      this.fireSelectionChange();\n    },\n\n    fireSelectionChange() {\n      let items = this.selectionN;\n      let item1 = this.selection1;\n      let dst = [];\n      if (items != null) {\n        for (var i in items) {\n          dst.push(items[i]);\n        }\n      }\n      if (dst.length == 0 && item1 != null) {\n        if (item1.name != null) {\n          dst.push(item1);\n        }\n      }\n      this.$emit(\"selection-change\", dst);\n    },\n\n    formatByteSize(row, column, cellValue, index) {\n      nop(row, column, index);\n      return ByteJS.StringifySize(cellValue);\n    },\n\n    formatTimestamp(row, column, cellValue, index) {\n      nop(row, column, index);\n      return TimeJS.StringifyTimestamp(cellValue);\n    },\n  },\n\n  props: {\n    bank: String,\n    multipleSelection: Boolean,\n  },\n};\n</script>\n\n<style scoped>\n</style>\n","\n\n\nfunction tryStringifySizeWithUnit(size, per, unit) {\n    let n = size / per\n    if (n < 1) {\n        return null;\n    }\n    let str = ''\n    if (n < 5) {\n        str = n.toFixed(1)\n    } else {\n        str = n.toFixed(0)\n    }\n    return str + unit;\n}\n\n\n/**\n * 文本化字节数\n*/\nfunction StringifySize(size) {\n\n    const pKB = 1024\n    const pMB = 1024 * 1024\n    const pGB = 1024 * 1024 * 1024\n\n    let str = tryStringifySizeWithUnit(size, pGB, \" GB\")\n    if (str != null) {\n        return str\n    }\n\n    str = tryStringifySizeWithUnit(size, pMB, \" MB\")\n    if (str != null) {\n        return str\n    }\n\n    str = tryStringifySizeWithUnit(size, pKB, \" KB\")\n    if (str != null) {\n        return str\n    }\n\n    return size + \" B\"\n}\n\n\n\nexport default {\n    name: \"BytesJS\",\n\n    StringifySize\n}\n","import { render } from \"./view-detail-table.vue?vue&type=template&id=4ea26058\"\nimport script from \"./view-detail-table.vue?vue&type=script&lang=js\"\nexport * from \"./view-detail-table.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"F:\\\\home\\\\xukun\\\\git.bitwormhole\\\\wpm-ui\\\\vuejs\\\\wpm-station-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div>\n    <el-dialog\n      :modelValue=\"modelValue\"\n      @update:modelValue=\"updateModelValue\"\n      width=\"66%\"\n      :fullscreen=\"false\"\n      :title=\"dialogTitle\"\n    >\n      <MyPathBar :bank=\"bank\" />\n\n      <div class=\"toolbar toolbar-top\">\n        <el-button @click=\"handleClickGoUp\">\n          <el-icon> <TopLeft /> </el-icon> 向上\n        </el-button>\n\n        <el-button @click=\"handleClickRefresh\">\n          <el-icon> <Refresh /> </el-icon> 刷新</el-button\n        >\n        <el-button @click=\"handleClickMakeDir\">\n          <el-icon> <Plus /> </el-icon> 新建文件夹</el-button\n        >\n\n        <el-input\n          class=\"input-file-name\"\n          v-model=\"filename\"\n          placeholder=\"文件(或目录)名\"\n        ></el-input>\n\n        <el-button type=\"success\" @click=\"handleClickOK\">\n          {{ actionText }}\n        </el-button>\n\n        <el-button type=\"default\" @click=\"handleClickCancel\">取消</el-button>\n      </div>\n\n      <MyDetailView :bank=\"bank\" @selection-change=\"handleSelectionChange\" />\n      <div class=\"toolbar toolbar-bottom\"></div>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { Refresh, Plus, TopLeft } from \"@element-plus/icons-vue\";\n</script>\n\n<script>\nimport MyPathBar from \"./path-bar.vue\";\nimport MyDetailView from \"./view-detail-table.vue\";\nimport { ElMessageBox } from \"element-plus\";\n\nexport default {\n  name: \"filebrowser-dialog-common\",\n\n  components: { MyPathBar, MyDetailView },\n\n  computed: {\n    dialogTitle() {\n      let title = this.title;\n      if (title != null) {\n        if (title != \"\") {\n          return title;\n        }\n      }\n      let s1 = this.actionText;\n      let s2 = this.wantText;\n      return s1 + s2;\n    },\n\n    actionText() {\n      let value = this.action;\n      return value == \"save\" ? \"保存\" : \"打开\";\n    },\n\n    wantText() {\n      let value = this.want;\n      return value == \"folder\" || value == \"directory\" ? \"文件夹\" : \"文件\";\n    },\n  },\n\n  data() {\n    return {\n      filename: \"\",\n      selectedItems: [],\n    };\n  },\n\n  methods: {\n    refresh() {\n      let bank = this.bank;\n      this.$store.dispatch(\"files/fetch\", { bank });\n    },\n\n    updateModelValue(p) {\n      this.$emit(\"update:modelValue\", p);\n    },\n\n    handleClickRefresh() {\n      this.refresh();\n    },\n\n    handleClickGoUp() {\n      let bank = this.bank;\n      let href = \"..\";\n      this.$store.dispatch(\"files/fetch\", { bank, href });\n    },\n\n    handleClickMakeDir() {\n      let title = \"新建文件夹\";\n      let text = \"请输入文件夹名称\";\n      ElMessageBox.prompt(text, title, {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n      })\n        .then(() => {\n          console.warn(\"todo: mkdir\");\n        })\n        .catch(() => {});\n    },\n\n    handleClickCancel() {\n      this.updateModelValue(false);\n    },\n\n    handleClickOK() {\n      this.updateModelValue(false);\n      let list = this.selectedItems;\n      if (this.action == \"save\") {\n        this.$emit(\"save-file\", list);\n      } else {\n        this.$emit(\"open-file\", list);\n      }\n    },\n\n    handleSelectionChange(items) {\n      if (items == null) {\n        return;\n      }\n      if (items.length == 1) {\n        this.filename = items[0].name;\n        this.selectedItems = items;\n        return;\n      }\n      let sep = \"\";\n      let str = \"\";\n      for (var i in items) {\n        let it = items[i];\n        str += sep + \"'\" + it.name + \"'\";\n        sep = \", \";\n      }\n      this.selectedItems = items;\n      this.filename = str;\n    },\n\n    init() {\n      let path = \"/\";\n      let base = \"file:///\";\n      let bank = this.bank;\n      this.$store.commit(\"files/init\", { bank, path, base });\n    },\n  },\n\n  mounted() {\n    this.init();\n  },\n\n  props: {\n    modelValue: Boolean,\n    bank: String,\n    title: String,\n    want: String, // ['file'|'folder']\n    action: String, // ['open'|'save']\n    multipleSelection: Boolean,\n  },\n\n  watch: {\n    modelValue(newValue, oldValue) {\n      if (newValue == true && oldValue == false) {\n        this.refresh();\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.toolbar {\n  display: flex;\n  flex-direction: row;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.input-file-name {\n  flex-grow: 1;\n  margin-left: 10px;\n  margin-right: 10px;\n}\n</style>\n","import script from \"./dialog-common.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./dialog-common.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./dialog-common.vue?vue&type=style&index=0&id=2a3b2d19&scoped=true&lang=css\"\n\nimport exportComponent from \"F:\\\\home\\\\xukun\\\\git.bitwormhole\\\\wpm-ui\\\\vuejs\\\\wpm-station-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2a3b2d19\"]])\n\nexport default __exports__","import { render } from \"./dialog-open.vue?vue&type=template&id=585f3254\"\nimport script from \"./dialog-open.vue?vue&type=script&lang=js\"\nexport * from \"./dialog-open.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"F:\\\\home\\\\xukun\\\\git.bitwormhole\\\\wpm-ui\\\\vuejs\\\\wpm-station-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["stringifyNumWithWidth","num","width","str","length","StringifyTimestamp","ms","fmt","t","Date","setTime","StringifyDate","date","YY","getFullYear","MM","getMonth","DD","getDate","hh","getHours","mm","getMinutes","ss","getSeconds","sep","ymd","hms","has_ymd","has_hms","s1","s2","s3","name","_createElementBlock","_createVNode","_component_MyDialogCommon","modelValue","$props","bank","multipleSelection","$options","updateModelValue","onOpenFile","handleOpenFile","__default__","computed","items","this","makeItems","elements","$store","getters","data","mode","current","edit","pathText","methods","handleClickEdit","path","handleClickGo","navTo","handleClickCancel","handleClickPathItem","item","handleClickPathRoot","src","dst","dir","i","makeItem","push","parent","dispatch","props","String","__exports__","_component_el_table","ref","onSelectionChange","handleSelectionChange","onCurrentChange","handleCurrentChange","_component_el_table_column","type","tableColumnType","prop","label","sortable","default","_withCtx","scope","_component_el_button","link","onClick","$event","handleClickItemName","row","formatter","formatTimestamp","formatByteSize","tryStringifySizeWithUnit","size","per","unit","n","toFixed","StringifySize","pKB","pMB","pGB","nop","selection1","selectionN","is_dir","openDir","href","getFieldByName","currentRow","fireSelectionChange","rows","$refs","theTable","getSelectionRows","item1","$emit","column","cellValue","index","ByteJS","TimeJS","Boolean","components","MyPathBar","MyDetailView","dialogTitle","title","actionText","wantText","value","action","want","filename","selectedItems","refresh","p","handleClickRefresh","handleClickGoUp","handleClickMakeDir","text","ElMessageBox","confirmButtonText","cancelButtonText","then","console","warn","catch","handleClickOK","list","it","init","base","commit","mounted","watch","newValue","oldValue","MyDialogCommon","files","render"],"sourceRoot":""}
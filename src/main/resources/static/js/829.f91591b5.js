"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[829],{1829:function(e,t,n){n.r(t),n.d(t,{default:function(){return ie}});var a=n(3396);function l(e,t,n,l,i,s){const r=(0,a.up)("ClientViewIndex"),o=(0,a.up)("AdminFrame");return(0,a.wg)(),(0,a.j4)(o,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r)])),_:1})}const i=e=>((0,a.dD)("data-v-6a02b02c"),e=e(),(0,a.Cn)(),e),s={class:"settings-index-page"},r=i((()=>(0,a._)("h1",null,"插件",-1)));function o(e,t,n,l,i,o){const d=(0,a.up)("MyToolbar"),u=(0,a.up)("MySearch"),c=(0,a.up)("MyPager"),m=(0,a.up)("MyTable"),p=(0,a.up)("MyEdit");return(0,a.wg)(),(0,a.iD)("div",s,[r,(0,a.Wm)(d,{onAction:o.handleAction},null,8,["onAction"]),(0,a.Wm)(u,{class:"search-box"}),(0,a.Wm)(c,{class:"pager-box"}),(0,a.Wm)(m,{onAction:o.handleAction},null,8,["onAction"]),(0,a.Wm)(p,{method:"POST",enabled:i.theAddEnabled,"onUpdate:enabled":t[0]||(t[0]=e=>i.theAddEnabled=e),item:i.theAddItem,"onUpdate:item":t[1]||(t[1]=e=>i.theAddItem=e)},null,8,["enabled","item"]),(0,a.Wm)(p,{method:"PUT",enabled:i.theEditEnabled,"onUpdate:enabled":t[2]||(t[2]=e=>i.theEditEnabled=e),item:i.theEditItem,"onUpdate:item":t[3]||(t[3]=e=>i.theEditItem=e)},null,8,["enabled","item"])])}var d=n(7139);const u=["title"];function c(e,t,n,l,i,s){const r=(0,a.up)("el-button"),o=(0,a.up)("el-table-column"),c=(0,a.up)("MyInstallingState"),m=(0,a.up)("el-table"),p=(0,a.up)("MyItemDetailDialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(m,{data:s.items},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{prop:"name",label:"名称"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{link:"",type:"primary",onClick:t=>s.openItemDetail(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),(0,a.Wm)(o,{prop:"title",label:"标题"},{default:(0,a.w5)((e=>[(0,a._)("span",{title:e.row.description},(0,d.zw)(e.row.title),9,u)])),_:1}),(0,a.Wm)(o,{prop:"version",label:"版本"}),(0,a.Wm)(o,{prop:"state",label:"状态"},{default:(0,a.w5)((e=>[(0,a.Wm)(c,{modelValue:e.row.state},null,8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"操作",width:"170px"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{link:"",type:"primary",onClick:t=>s.openItemDetail(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("详情")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,a.Wm)(p,{class:"plug-in-detail-dialog",modelValue:i.displayDetailDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>i.displayDetailDialog=e),target:i.theDetailDialogTarget,onAction:s.handleAction},null,8,["modelValue","target","onAction"])])}var m=n(9242);const p={class:"box-area-1"},h={class:"item-icon-box"},g=["src"],f={class:"box-area-2"},b={class:"box-area-3"};function w(e,t,n,l,i,s){const r=(0,a.up)("MyInstallingState"),o=(0,a.up)("el-form-item"),u=(0,a.up)("el-form"),c=(0,a.up)("el-divider"),w=(0,a.up)("el-button"),k=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(k,{title:s.dialogTitle,onOpen:s.handleOpen},{default:(0,a.w5)((()=>[(0,a._)("div",p,[(0,a._)("div",h,[(0,a._)("img",{class:"item-icon-image",src:i.item.icon},null,8,g)]),(0,a._)("div",null,[(0,a._)("h2",null,(0,d.zw)(i.item.name),1),(0,a._)("h4",null,(0,d.zw)(i.item.title),1),(0,a.Wm)(u,{"label-width":"100"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{label:"状态"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:i.item.state},null,8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"版本"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(i.packVersion),1)])),_:1}),(0,a.Wm)(o,{label:"大小"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(i.packSize),1)])),_:1}),(0,a.Wm)(o,{label:"更新时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(i.packDate),1)])),_:1})])),_:1})])]),(0,a._)("div",f,[(0,a.Wm)(c),(0,a._)("p",null,(0,d.zw)(i.item.description),1),(0,a.Wm)(c)]),(0,a._)("div",b,[(0,a.wy)((0,a.Wm)(w,{type:"success",onClick:s.install,disabled:!s.canInstall},{default:(0,a.w5)((()=>[(0,a.Uk)(" 安装 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canInstall]]),(0,a.wy)((0,a.Wm)(w,{type:"default",link:"",onClick:s.upgrade,disabled:!s.canUpgrade},{default:(0,a.w5)((()=>[(0,a.Uk)(" 升级 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canUpgrade]]),(0,a.wy)((0,a.Wm)(w,{type:"default",link:"",onClick:s.reinstall,disabled:!s.canReInstall},{default:(0,a.w5)((()=>[(0,a.Uk)(" 重新安装 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canReInstall]]),(0,a.wy)((0,a.Wm)(w,{type:"danger",onClick:s.uninstall,disabled:!s.canUninstall},{default:(0,a.w5)((()=>[(0,a.Uk)(" 卸载 ")])),_:1},8,["onClick","disabled"]),[[m.F8,s.canUninstall]])])])),_:1},8,["title","onOpen"])}var k=n(4870),_=n(2748);const v={na:"不可用",INSTALLED:"已安装",NEWVERSION:"可升级",AVAILABLE:"未安装"},y={name:"settings-plug-ins-installing-state",computed:{text(){let e=this.modelValue,t=v[e];return null==t&&(t=e),t},canUpgrade(){return"NEWVERSION"==this.modelValue},installed(){return"INSTALLED"==this.modelValue}},props:{modelValue:String}};var I=Object.assign(y,{setup(e){return(e,t)=>{const n=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.wy)((0,a.Wm)(n,{class:"icon-info"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,k.SU)(_.cEj))])),_:1},512),[[m.F8,e.canUpgrade]]),(0,a.Uk)(" "+(0,d.zw)(e.text)+" ",1),(0,a.wy)((0,a.Wm)(n,{class:"icon-success"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,k.SU)(_.c5o))])),_:1},512),[[m.F8,e.installed]])])}}}),S=n(89);const W=(0,S.Z)(I,[["__scopeId","data-v-1ccceb51"]]);var C=W,D=n(9466),A=n(2875);function U(){this.latest=null,this.current=null}U.prototype={add(e){e.installed&&(this.current=e),this.latest=e},stringifyItems(e,t){let n=this.current,a=this.latest,l=[n,a],i="",s="",r=null;for(var o in l){let n=l[o];if(null==n)continue;let a=n[e];if(null==a)continue;if(n.id==r)break;r=n.id;let d=t(a);i=i+s+d,s=" ==> "}return i},getVersion(){return this.stringifyItems("version",(e=>e))},getSize(){return this.stringifyItems("size",(e=>A.Z.StringifySize(e)))},getDate(){return this.stringifyItems("release_at",(e=>D.Z.StringifyTimestamp(e)))}};var z={name:"settings-plug-ins-item-detail-dialog",components:{MyInstallingState:C},computed:{dialogTitle(){return"插件详情"},canInstall(){return!this.item.installed},canUninstall(){return this.item.installed},canReInstall(){return this.item.installed},canUpgrade(){return"NEWVERSION"==this.item.state}},data(){return{item:{},packVersion:"",packSize:"",packDate:""}},methods:{install(){this.fireAction("install")},reinstall(){this.fireAction("re-install")},uninstall(){this.fireAction("uninstall")},upgrade(){this.fireAction("upgrade")},fireAction(e){let t=this.target,n={name:e,target:t};this.$emit("action",n),this.close()},prepareItem(e){let t=JSON.stringify(e),n=JSON.parse(t),a=n.packages,l=new U;if(null!=a)for(var i in a)l.add(a[i]);return this.packVersion=l.getVersion(),this.packSize=l.getSize(),this.packDate=l.getDate(),n},handleOpen(){let e=this.target;null!=e&&(this.item=this.prepareItem(e))},close(){this.$emit("update:modelValue",!1)}},props:{target:Object},watch:{}};const E=(0,S.Z)(z,[["render",w],["__scopeId","data-v-b0afa99c"]]);var V=E;var x={name:"settings-plug-ins-table",components:{MyItemDetailDialog:V,MyInstallingState:C},computed:{items(){return this.$store.getters["soft_set/list"]}},data(){return{theDetailDialogTarget:{},displayDetailDialog:!1}},methods:{openItemDetail(e){this.theDetailDialogTarget=e,this.displayDetailDialog=!0},handleAction(e){this.$emit("action",e)}},mounted(){}};const M=(0,S.Z)(x,[["render",c],["__scopeId","data-v-f8f70aba"]]);var T=M;function $(e,t,n,l,i,s){const r=(0,a.up)("el-pagination");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{"current-page":s.currentPage,"page-size":s.pageSize,"page-sizes":[5,10,20,50,100,200,500],background:i.background,layout:"total, sizes, prev, pager, next",total:s.theCountItemsTotal,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}const N="soft_set/";var O={name:"settings-plug-ins-table",computed:{currentPage(){return this.$store.getters[N+"current_page"]},pageSize(){return this.$store.getters[N+"page_size"]},theCountItemsTotal(){return this.$store.getters[N+"total"]}},data(){return{background:!1}},methods:{handleSizeChange(e){let t=e,n=0;this.$store.commit(N+"update",{index:n,size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit(N+"update",{index:t})}},mounted(){}};const Z=(0,S.Z)(O,[["render",$]]);var F=Z;function P(e,t,n,l,i,s){return(0,a.wg)(),(0,a.iD)("div")}var L={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{},mounted(){}};const R=(0,S.Z)(L,[["render",P]]);var j=R;function J(e,t,n,l,i,s){const r=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{onClick:s.refresh},{default:(0,a.w5)((()=>[(0,a.Uk)(" 刷新 ")])),_:1},8,["onClick"]),(0,a.Wm)(r,{onClick:s.handleClickUpdate},{default:(0,a.w5)((()=>[(0,a.Uk)(" 更新插件列表 ")])),_:1},8,["onClick"])])}var B={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{fetch(){this.$store.dispatch("soft_set/fetch")},refresh(){this.fetch()},handleClickUpdate(){this.$store.dispatch("soft_pack/update_sources")}},mounted(){this.fetch()}};const q=(0,S.Z)(B,[["render",J]]);var G=q;function H(e,t,n,l,i,s){return(0,a.wg)(),(0,a.iD)("div")}var K={name:"settings-plug-ins-table",computed:{},data(){return{}},methods:{},mounted(){}};const Q=(0,S.Z)(K,[["render",H]]);var X=Q,Y=n(4775),ee={name:"settings-executables",components:{MyTable:T,MyPager:F,MySearch:j,MyToolbar:G,MyEdit:X},data(){return{theAddItem:{},theAddEnabled:!1,theEditItem:{},theEditEnabled:!1}},methods:{handleAction(e){let t=e.name;"edit"==t?this.edit(e.item):"add"==t?this.add():"install"==t?this.installSet(e.target):"uninstall"==t?this.uninstallSet(e.target):"re-install"==t?this.reInstallSet(e.target):"upgrade"==t&&this.upgradeSet(e.target)},add(){this.theAddItem={icon:"/image/exe-icons/default.png"},this.theAddEnabled=!0},installSet(e){let t="正在安装...",n={fullscreen:!0,text:t};const a=Y.kN.service(n);this.$store.dispatch("soft_set/install",{item:e}).finally((()=>{a.close()}))},uninstallSet(e){let t="正在卸载...",n={fullscreen:!0,text:t};const a=Y.kN.service(n);this.$store.dispatch("soft_set/uninstall",{item:e}).finally((()=>{a.close()}))},reInstallSet(e){let t="正在重新安装...",n={fullscreen:!0,text:t};const a=Y.kN.service(n);this.$store.dispatch("soft_set/reinstall",{item:e}).finally((()=>{a.close()}))},upgradeSet(e){let t={fullscreen:!0,text:"正在升级..."};const n=Y.kN.service(t);this.$store.dispatch("soft_set/upgrade",{item:e}).finally((()=>{n.close()}))},edit(e){this.theEditItem=e,this.theEditEnabled=!0}}};const te=(0,S.Z)(ee,[["render",o],["__scopeId","data-v-6a02b02c"]]);var ne=te,ae={name:"SettingsPlugInsView",components:{ClientViewIndex:ne}};const le=(0,S.Z)(ae,[["render",l]]);var ie=le}}]);
//# sourceMappingURL=829.f91591b5.js.map
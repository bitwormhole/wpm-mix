"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[898],{3898:function(e,t,l){l.r(t),l.d(t,{default:function(){return ne}});var a=l(3396);function i(e,t,l,i,o,n){const r=(0,a.up)("SettingsIndex"),s=(0,a.up)("AdminFrame");return(0,a.wg)(),(0,a.j4)(s,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r)])),_:1})}const o=e=>((0,a.dD)("data-v-7945e7a6"),e=e(),(0,a.Cn)(),e),n={class:"settings-index-page"},r=o((()=>(0,a._)("h1",null,"本地仓库",-1)));function s(e,t,l,i,o,s){const d=(0,a.up)("MyToolbar"),m=(0,a.up)("MySearch"),u=(0,a.up)("MyPager"),c=(0,a.up)("MyTable"),p=(0,a.up)("MyEdit");return(0,a.wg)(),(0,a.iD)("div",n,[r,(0,a.Wm)(d),(0,a.Wm)(m,{class:"search-box"}),(0,a.Wm)(u,{class:"pager-box"}),(0,a.Wm)(c,{onAction:s.handleAction},null,8,["onAction"]),(0,a.Wm)(p,{modelValue:o.displayEditDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>o.displayEditDialog=e),item:o.theEditItem},null,8,["modelValue","item"])])}const d={class:"operation-buttons"};function m(e,t,l,i,o,n){const r=(0,a.up)("el-table-column"),s=(0,a.up)("FileStateView"),m=(0,a.up)("el-button"),u=(0,a.up)("el-table"),c=(0,a.up)("MyItemDetailDialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(u,{data:n.items,"default-sort":{prop:"name",order:"descending"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"名称",prop:"name",sortable:""}),(0,a.Wm)(r,{label:"路径",prop:"path",sortable:""}),(0,a.Wm)(r,{label:"状态",prop:"state",sortable:""},{default:(0,a.w5)((e=>[(0,a.Wm)(s,{code:e.row.state},null,8,["code"])])),_:1}),(0,a.Wm)(r,{label:"操作",width:"170px"},{default:(0,a.w5)((e=>[(0,a._)("div",d,[(0,a.Wm)(m,{type:"primary",link:"",onClick:t=>n.handleClickItemDetail(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("详情")])),_:2},1032,["onClick"]),(0,a.Wm)(m,{type:"primary",link:"",onClick:t=>n.handleClickEditItem(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(m,{type:"danger",link:"",onClick:t=>n.handleClickRemoveItem(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("移除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),(0,a.Wm)(c,{modelValue:o.displayDetailDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>o.displayDetailDialog=e),target:o.currentItem},null,8,["modelValue","target"])])}l(7658);var u=l(2655),c=l(3312),p=l(7139);function h(e,t,l,i,o,n){const r=(0,a.up)("el-form-item"),s=(0,a.up)("el-form"),d=(0,a.up)("ElButton"),m=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(m,{title:"本地仓库详情","align-center":"",width:"640px"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{"label-width":"128px"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"名称"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.name),1)])),_:1}),(0,a.Wm)(r,{label:"标题"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.label),1)])),_:1}),(0,a.Wm)(r,{label:"标签"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.tags),1)])),_:1}),(0,a.Wm)(r,{label:"ID / UUID"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.id)+" / "+(0,p.zw)(n.item.uuid),1)])),_:1}),(0,a.Wm)(r,{label:"分组"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.group),1)])),_:1}),(0,a.Wm)(r,{label:"有工作区"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(!n.item.bare),1)])),_:1}),(0,a.Wm)(r,{label:"路径"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.repository_path),1)])),_:1}),(0,a.Wm)(r,{label:"状态"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.state),1)])),_:1}),(0,a.Wm)(r,{label:"描述"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.item.description),1)])),_:1}),(0,a.Wm)(r,{label:"创建时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.formatTime(n.item.created_at)),1)])),_:1}),(0,a.Wm)(r,{label:"修改时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(n.formatTime(n.item.updated_at)),1)])),_:1})])),_:1}),(0,a._)("div",null,[(0,a.Wm)(d,{type:"default",onClick:n.close},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1},8,["onClick"])])])),_:1})}var g=l(6465),w=l(9466),_={name:"settings-local-repository-item-detail-dialog",components:{ElButton:g.mi},computed:{item(){return this.target}},methods:{close(){this.$emit("update:modelValue",!1)},formatTime(e){return w.Z.StringifyTimestamp(e,"datetime")}},props:{target:Object}},f=l(89);const b=(0,f.Z)(_,[["render",h]]);var k=b,W={name:"settings-local-repositories-table",components:{FileStateView:c.Z,MyItemDetailDialog:k},computed:{items(){return this.$store.getters["local_repository/currentPageItems"]},currentPageIds(){let e=this.items,t=[];if(null==e)return t;for(var l in e){let a=e[l];t.push(a.id)}return t},currentPageIdstr(){let e=this.currentPageIds,t="";for(var l in e){let a=e[l];t+=a+"."}return t}},data(){return{displayDetailDialog:!1,currentItem:{}}},methods:{handleClickEditItem(e){let t="edit",l={name:t,item:e};this.$emit("action",l)},handleClickItemDetail(e){this.currentItem=e,this.displayDetailDialog=!0},handleClickRemoveItem(e){let t="移除仓库",l="确定要移除 ["+e.name+"] 这个仓库吗？",a="该操作不会把磁盘上的仓库数据删除，仅将对它的引用从WPM数据库中移除。";u.T.confirm(l+a,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},removeItem(e){this.$store.dispatch("local_repository/remove",e)},fetchByIds(e){this.$store.dispatch("local_repository/fetchByIds",{ids:e})}},watch:{currentPageIdstr(){this.fetchByIds(this.currentPageIds)}}};const y=(0,f.Z)(W,[["render",m],["__scopeId","data-v-6262cfac"]]);var v=y;function C(e,t,l,i,o,n){const r=(0,a.up)("el-pagination");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{"current-page":o.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>o.currentPage=e),"page-size":o.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>o.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:o.background,layout:"total, sizes, prev, pager, next",total:n.theCountItemsTotal,onSizeChange:n.handleSizeChange,onCurrentChange:n.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var I={name:"settings-local-repositories-table",computed:{items(){return[]},theCountItemsTotal(){return this.$store.getters["local_repository/total"]}},data(){return{currentPage:1,pageSize:10,background:!0}},methods:{handleSizeChange(e){let t=e;this.$store.commit("local_repository/update",{size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit("local_repository/update",{index:t})}},mounted(){this.handleCurrentChange(this.currentPage),this.handleSizeChange(this.pageSize)}};const U=(0,f.Z)(I,[["render",C]]);var D=U,V=l(4870),z=l(2748);const S={name:"settings-local-repositories-table",computed:{},data(){return{searchtext:""}},methods:{applyFilter(e){this.searchtext=e,this.$store.commit("local_repository/update",{filter:e})}}};var M=Object.assign(S,{setup(e){return(e,t)=>{const l=(0,a.up)("el-icon"),i=(0,a.up)("el-button"),o=(0,a.up)("el-input");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(o,{modelValue:e.searchtext,onInput:e.applyFilter,clearable:"",placeholder:"请输入要查找的内容"},{append:(0,a.w5)((()=>[(0,a.Wm)(i,{title:"查找"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.olm))])),_:1})])),_:1})])),_:1},8,["modelValue","onInput"])])}}});const x=M;var P=x;const $=e=>((0,a.dD)("data-v-af56694a"),e=e(),(0,a.Cn)(),e),E={class:"mode-list"},T=$((()=>(0,a._)("div",{class:"mode-item-icon"},[(0,a._)("img",{class:"mode-item-icon-img",src:"/image/icon_repo.png"})],-1))),j={class:"mode-item-label"},O=$((()=>(0,a._)("span",{class:"mode-item-label-text"}," 导入单个仓库 ",-1))),Z=$((()=>(0,a._)("div",{class:"mode-item-icon"},[(0,a._)("img",{class:"mode-item-icon-img",src:"/image/icon_repos.png"})],-1))),B={class:"mode-item-label"},A=$((()=>(0,a._)("span",{class:"mode-item-label-text"}," 批量导入仓库 ",-1))),F={name:"settings-insert-local-repo-mode-dialog",data(){return{}},methods:{importMulti(){this.$router.push("/import-local-repositories")},importOne(){this.$router.push("/import-local-repository")},close(){this.updateModelValue(!1)}},props:{}};var R=Object.assign(F,{setup(e){return(e,t)=>{const l=(0,a.up)("el-icon"),i=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(i,{title:"请选择"},{default:(0,a.w5)((()=>[(0,a._)("div",E,[(0,a._)("div",{class:"mode-item",onClick:t[0]||(t[0]=(...t)=>e.importOne&&e.importOne(...t))},[T,(0,a._)("div",j,[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.v37))])),_:1}),O])]),(0,a._)("div",{class:"mode-item",onClick:t[1]||(t[1]=(...t)=>e.importMulti&&e.importMulti(...t))},[Z,(0,a._)("div",B,[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.v37))])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.v37))])),_:1}),A])])])])),_:1})}}});const J=(0,f.Z)(R,[["__scopeId","data-v-af56694a"]]);var N=J;const Y={class:"toolbar"},q={name:"settings-local-repositories-toolbar",components:{MyInsertModeDialog:N},data(){return{displayInsertModeDialog:!1}},methods:{fetch(){this.$store.dispatch("local_repository/fetch",{})},handleClickAdd(){this.displayInsertModeDialog=!0},handleClickRefresh(){this.fetch()}},mounted(){this.fetch()}};var G=Object.assign(q,{setup(e){return(e,t)=>{const l=(0,a.up)("el-icon"),i=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",Y,[(0,a.Wm)(i,{onClick:e.handleClickRefresh,title:"刷新"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.hYj))])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(i,{onClick:e.handleClickAdd,title:"添加本地仓库"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,V.SU)(z.v37))])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(N,{modelValue:e.displayInsertModeDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.displayInsertModeDialog=t)},null,8,["modelValue"])])}}});const H=(0,f.Z)(G,[["__scopeId","data-v-87cbbbea"]]);var K=H;function L(e,t,l,i,o,n){const r=(0,a.up)("el-input"),s=(0,a.up)("el-form-item"),d=(0,a.up)("el-form"),m=(0,a.up)("el-button"),u=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(u,{title:"修改仓库",modelValue:l.modelValue,"onUpdate:modelValue":n.updateModelValue},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{"label-width":"120px"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{label:"名称"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.item1.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.item1.name=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(s,{label:"路径"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.item1.path,"onUpdate:modelValue":t[1]||(t[1]=e=>o.item1.path=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(s,{label:"路径（工作区）"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(o.item1.workspace_path),1)])),_:1}),(0,a.Wm)(s,{label:"路径（库）"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(o.item1.repository_path),1)])),_:1}),(0,a.Wm)(s,{label:"描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"textarea",modelValue:o.item1.description,"onUpdate:modelValue":t[2]||(t[2]=e=>o.item1.description=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,a._)("div",null,[(0,a.Wm)(m,{type:"success",onClick:n.handleClickSave},{default:(0,a.w5)((()=>[(0,a.Uk)("保存")])),_:1},8,["onClick"]),(0,a.Wm)(m,{type:"default",onClick:n.handleClickCancel},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","onUpdate:modelValue"])}var Q={name:"local-repo-item-edit",data(){return{item1:{}}},methods:{updateModelValue(e){this.$emit("update:modelValue",e)},handleClickSave(){let e=this.item1;this.$store.dispatch("local_repository/update",e).then((()=>{this.close()}))},handleClickCancel(){this.close()},close(){this.updateModelValue(!1)}},props:{modelValue:Boolean,item:Object},watch:{item(e){let t=JSON.stringify(e);this.item1=JSON.parse(t)}}};const X=(0,f.Z)(Q,[["render",L]]);var ee=X,te={name:"settings-local-repositories",components:{MyTable:v,MyPager:D,MySearch:P,MyToolbar:K,MyEdit:ee},data(){return{displayEditDialog:!1,theEditItem:{}}},methods:{handleAction(e){let t=e.name;"edit"==t?this.editItem(e.item):"detail"==t?this.openItemDetail(e.item):console.warn("unsupported action:"+t)},editItem(e){this.theEditItem=e,this.displayEditDialog=!0},openItemDetail(e){this.nop(e)},nop(){}}};const le=(0,f.Z)(te,[["render",s],["__scopeId","data-v-7945e7a6"]]);var ae=le,ie={name:"views-settings-local-repositories",components:{SettingsIndex:ae}};const oe=(0,f.Z)(ie,[["render",i]]);var ne=oe}}]);
//# sourceMappingURL=898.201e97f0.js.map
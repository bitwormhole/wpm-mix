"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[185],{6185:function(e,t,l){l.r(t),l.d(t,{default:function(){return te}});var a=l(3396);function n(e,t,l,n,r,o){const i=(0,a.up)("MyClient"),u=(0,a.up)("AdminFrame");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i)])),_:1})}const r=e=>((0,a.dD)("data-v-e8d03986"),e=e(),(0,a.Cn)(),e),o={class:"settings-project-page"},i=r((()=>(0,a._)("h1",null,"工程项目",-1)));function u(e,t,l,n,r,u){const s=(0,a.up)("MyToolbar"),d=(0,a.up)("MySearch"),c=(0,a.up)("MyPager"),p=(0,a.up)("MyTable"),m=(0,a.up)("MyInsertDialog");return(0,a.wg)(),(0,a.iD)("div",o,[i,(0,a.Wm)(s,{onAction:u.handleAction},null,8,["onAction"]),(0,a.Wm)(d,{class:"search-box"}),(0,a.Wm)(c,{class:"pager-box"}),(0,a.Wm)(p,{onAction:u.handleAction},null,8,["onAction"]),(0,a.Wm)(m,{modelValue:r.displayInsertDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>r.displayInsertDialog=e),target:r.theInsertDialogTarget,title:"导入工程项目",method:"POST"},null,8,["modelValue","target"])])}var s=l(4870),d=l(2748);const c={class:"toolbar"},p={name:"settings-projects-toolbar",methods:{handleClickAdd(){const e="insert";this.$emit("action",{name:e})},handleClickRefresh(){this.$store.dispatch("project/fetch",{all:1})}}};var m=Object.assign(p,{setup(e){return(e,t)=>{const l=(0,a.up)("el-icon"),n=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a.Wm)(n,{onClick:e.handleClickRefresh,title:"刷新"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,s.SU)(d.hYj))])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(n,{onClick:e.handleClickAdd,title:"添加本地仓库"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,s.SU)(d.v37))])),_:1})])),_:1},8,["onClick"])])}}}),h=l(89);const g=(0,h.Z)(m,[["__scopeId","data-v-613b5924"]]);var f=g;const w={class:"search-box"},_={name:"settings-projects-search",computed:{searchtext(){return this.$store.getters["project/filterText"]}},methods:{applyFilter(e){this.$store.commit("project/setFilter",{text:e})}}};var y=Object.assign(_,{setup(e){return(e,t)=>{const l=(0,a.up)("el-icon"),n=(0,a.up)("el-button"),r=(0,a.up)("el-input");return(0,a.wg)(),(0,a.iD)("div",w,[(0,a.Wm)(r,{modelValue:e.searchtext,onInput:e.applyFilter,clearable:"",placeholder:"请输入要查找的内容"},{append:(0,a.w5)((()=>[(0,a.Wm)(n,{title:"查找"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,s.SU)(d.olm))])),_:1})])),_:1})])),_:1},8,["modelValue","onInput"])])}}});const b=(0,h.Z)(y,[["__scopeId","data-v-697ff3a0"]]);var k=b;const W={class:"pager"};function D(e,t,l,n,r,o){const i=(0,a.up)("el-pagination");return(0,a.wg)(),(0,a.iD)("div",W,[(0,a.Wm)(i,{"current-page":o.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>o.currentPage=e),"page-size":o.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>o.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:r.background,layout:"total, sizes, prev, pager, next",total:o.theCountItemsTotal,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var C={name:"settings-projects-pager",computed:{items(){return[]},theCountItemsTotal(){return this.$store.getters["project/total"]},pageSize(){return this.$store.getters["project/pageSize"]},currentPage(){return this.$store.getters["project/currentPage"]}},data(){return{background:!0}},methods:{handleCurrentChange(e){let t=e-1;this.$store.commit("project/update",{index:t})},handleSizeChange(e){let t=e,l=0;this.$store.commit("project/update",{size:t,index:l})}}};const v=(0,h.Z)(C,[["render",D],["__scopeId","data-v-8fb73b9c"]]);var I=v,U=l(7139);const j=["title"];function V(e,t,l,n,r,o){const i=(0,a.up)("el-table-column"),u=(0,a.up)("FileStateView"),s=(0,a.up)("el-button"),d=(0,a.up)("el-table"),c=(0,a.up)("MyEditDialog"),p=(0,a.up)("MyItemDetailDialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(d,{data:o.items},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{prop:"name",label:"名称",sortable:""},{default:(0,a.w5)((e=>[(0,a._)("div",{title:e.row.path},(0,U.zw)(e.row.name),9,j)])),_:1}),(0,a.Wm)(i,{prop:"type",label:"类型",sortable:""}),(0,a.Wm)(i,{label:"状态",prop:"state"},{default:(0,a.w5)((e=>[(0,a.Wm)(u,{code:e.row.state},null,8,["code"])])),_:1}),(0,a.Wm)(i,{label:"操作",width:"170px"},{default:(0,a.w5)((e=>[(0,a.Wm)(s,{link:"",type:"primary",onClick:t=>o.handleClickItemDetail(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("详情")])),_:2},1032,["onClick"]),(0,a.Wm)(s,{link:"",type:"primary",onClick:t=>o.handleClickEditItem(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(s,{link:"",type:"danger",onClick:t=>o.handleClickDeleteItem(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,a.Wm)(c,{modelValue:r.displayDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>r.displayDialog=e),title:"编辑工程项目",target:r.targetItem,method:"PUT"},null,8,["modelValue","target"]),(0,a.Wm)(p,{modelValue:r.displayDetailDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>r.displayDetailDialog=e),target:e.theDetailDialogItem},null,8,["modelValue","target"])])}l(7658);var z=l(3312);function S(e,t,l,n,r,o){const i=(0,a.up)("el-input"),u=(0,a.up)("el-form-item"),s=(0,a.up)("el-button"),d=(0,a.up)("MyProjectTypeSelector"),c=(0,a.up)("el-form"),p=(0,a.up)("OpenFileDialog"),m=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:"名称"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:r.current.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.current.name=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"路径"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:r.current.path,"onUpdate:modelValue":t[1]||(t[1]=e=>r.current.path=e)},{append:(0,a.w5)((()=>[(0,a.Wm)(s,{onClick:o.handleClickBrowsePath},{default:(0,a.w5)((()=>[(0,a.Uk)(" 浏览 ")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"类型"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:r.current.type,"onUpdate:modelValue":t[2]||(t[2]=e=>r.current.type=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:r.current.description,"onUpdate:modelValue":t[3]||(t[3]=e=>r.current.description=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a._)("div",null,[(0,a.Wm)(s,{type:"success",onClick:o.save},{default:(0,a.w5)((()=>[(0,a.Uk)("保存")])),_:1},8,["onClick"]),(0,a.Wm)(s,{type:"default",onClick:o.close},{default:(0,a.w5)((()=>[(0,a.Uk)(" 取消 ")])),_:1},8,["onClick"])]),(0,a.Wm)(p,{modelValue:r.displayOpenFileDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>r.displayOpenFileDialog=e),onOpenFile:o.handleOpenExeFiles},null,8,["modelValue","onOpenFile"])])),_:1})}var T=l(4383);const P={name:"settings-project-types-options-selector",computed:{options(){return this.$store.getters["content_type/project_type_list"]}},data(){return{}},methods:{refresh(){this.$store.dispatch("content_type/fetch")},computeLabel(e){let t=e.label,l=e.patterns;return t+" ("+l+")"},fireUpdateModelValue(e){this.$emit("update:modelValue",e)}},props:{modelValue:String}};var M=Object.assign(P,{setup(e){return(t,l)=>{const n=(0,a.up)("el-option"),r=(0,a.up)("el-select"),o=(0,a.up)("el-icon"),i=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{"model-value":e.modelValue,"onUpdate:modelValue":t.fireUpdateModelValue,placeholder:"请选择"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.options,(e=>((0,a.wg)(),(0,a.j4)(n,{key:e.id,label:t.computeLabel(e),value:e.type},null,8,["label","value"])))),128)),(0,a.Wm)(n,{label:"未定义",value:0})])),_:1},8,["model-value","onUpdate:modelValue"]),(0,a.Wm)(i,{type:"default",title:"刷新",onClick:t.refresh},{default:(0,a.w5)((()=>[(0,a.Wm)(o,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,s.SU)(d.hYj))])),_:1})])),_:1},8,["onClick"])])}}});const O=M;var $=O,x={name:"settings-projects-edit-dialog",components:{OpenFileDialog:T.Z,MyProjectTypeSelector:$},data(){return{current:{},displayOpenFileDialog:!1}},methods:{handleClickBrowsePath(){this.displayOpenFileDialog=!0},handleOpenExeFiles(e){if(null==e)return;let t=e[0];if(null==t)return;let l=t.path;null!=l&&(this.current.path=l)},getActionName(){let e=this.method;return"POST"==e?"insert":"PUT"==e?"update":"no_action"},save(){let e=this.current,t=this.getActionName();this.$store.dispatch("project/"+t,{item:e}).then((()=>{this.close()}))},close(){this.$emit("update:modelValue",!1)},cloneObject(e){let t=JSON.stringify(e);return JSON.parse(t)}},props:{method:String,target:Object},watch:{target(e){this.current=this.cloneObject(e)}}};const F=(0,h.Z)(x,[["render",S]]);var A=F,Z=l(2655);function B(e,t,l,n,r,o){const i=(0,a.up)("el-form-item"),u=(0,a.up)("el-form"),s=(0,a.up)("ElButton"),d=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(d,{title:"工程项目详情","align-center":"",width:"800px"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{"label-width":"128px"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{label:"名称"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.name),1)])),_:1}),(0,a.Wm)(i,{label:"ID / UUID"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.id)+" / "+(0,U.zw)(o.item.uuid),1)])),_:1}),(0,a.Wm)(i,{label:"分组"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.group),1)])),_:1}),(0,a.Wm)(i,{label:"配置名称"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.config_file_name),1)])),_:1}),(0,a.Wm)(i,{label:"分组"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.group),1)])),_:1}),(0,a.Wm)(i,{label:"路径"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.path),1)])),_:1}),(0,a.Wm)(i,{label:"项目文件夹"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.project_dir),1)])),_:1}),(0,a.Wm)(i,{label:"状态"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.state),1)])),_:1}),(0,a.Wm)(i,{label:"标签"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.tags),1)])),_:1}),(0,a.Wm)(i,{label:"类型"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.type),1)])),_:1}),(0,a.Wm)(i,{label:"描述"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.item.description),1)])),_:1}),(0,a.Wm)(i,{label:"创建时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.formatTime(o.item.created_at)),1)])),_:1}),(0,a.Wm)(i,{label:"修改时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,U.zw)(o.formatTime(o.item.updated_at)),1)])),_:1})])),_:1}),(0,a._)("div",null,[(0,a.Wm)(s,{type:"default",onClick:o.close},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1},8,["onClick"])])])),_:1})}var E=l(6465),N=l(9466),Y={name:"settings-local-repository-item-detail-dialog",components:{ElButton:E.mi},computed:{item(){return this.target}},methods:{close(){this.$emit("update:modelValue",!1)},formatTime(e){return N.Z.StringifyTimestamp(e,"datetime")}},props:{target:Object}};const J=(0,h.Z)(Y,[["render",B]]);var L=J,R={name:"settings-projects-table",components:{MyEditDialog:A,FileStateView:z.Z,MyItemDetailDialog:L},computed:{items(){return this.$store.getters["project/listCurrentPage"]},currentPageIds(){let e=this.items,t=[];if(null==e)return t;for(var l in e){let a=e[l];t.push(a.id)}return t},currentPageIdstr(){let e=this.currentPageIds,t="";for(var l in e){let a=e[l];t+=a+"."}return t}},data(){return{displayDialog:!1,targetItem:{},theDetailDialogTarget:{},displayDetailDialog:!1}},methods:{formatItemState(){return"ready"},handleClickEditItem(e){this.displayDialog=!0,this.targetItem=e},handleClickItemDetail(e){this.theDetailDialogItem=e,this.displayDetailDialog=!0},handleClickDeleteItem(e){let t="移除工程",l="确定要移除 ["+e.name+"] 这个工程吗？",a="该操作不会把磁盘上的工程文件删除，仅将对它的引用从WPM数据库中移除。";Z.T.confirm(l+a,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},removeItem(e){this.$store.dispatch("project/remove",e)},fetchByIds(e){this.$store.dispatch("project/fetchByIds",{ids:e})}},watch:{currentPageIdstr(){this.fetchByIds(this.currentPageIds)}}};const H=(0,h.Z)(R,[["render",V]]);var K=H,q={name:"settings-projects",components:{MyToolbar:f,MySearch:k,MyPager:I,MyTable:K,MyInsertDialog:A},data(){return{displayInsertDialog:!1,theInsertDialogTarget:{}}},methods:{handleAction(e){let t=e.name;"refresh"==t?this.refresh():"insert"==t?this.insert():console.warn("unsupported action:"+t)},insert(){this.theInsertDialogTarget={},this.displayInsertDialog=!0},refresh(){this.$store.dispatch("project/fetch",{all:1})}},mounted(){this.refresh()}};const G=(0,h.Z)(q,[["render",u],["__scopeId","data-v-e8d03986"]]);var Q=G,X={name:"settings-projects",components:{MyClient:Q}};const ee=(0,h.Z)(X,[["render",n]]);var te=ee}}]);
//# sourceMappingURL=185.e92a8667.js.map
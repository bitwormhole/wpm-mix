"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[136],{9698:function(e,t,a){a.d(t,{Z:function(){return c}});var l=a(3396),n=a(7139),i=a(9242);const o={class:"utils-batch-tool-bar"},s={class:"the-count-box"};function r(e,t,a,r,d,u){return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("span",null,(0,n.zw)(a.title),1),(0,l._)("span",s,(0,n.zw)(u.count)+" 项 ",1),(0,l.WI)(e.$slots,"default",{},void 0,!0)],512)),[[i.F8,!u.hide]])}var d={name:"utils-batch-tool-bar",computed:{items(){let e=this.modelValue;return null==e&&(e=[]),e},count(){let e=this.items.length;return null==e?0:e},hide(){return!!this.hideEmpty&&this.count<=0}},props:{modelValue:Array,title:String,hideEmpty:Boolean}},u=a(89);const m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-5c44dc71"]]);var c=m},4136:function(e,t,a){a.r(t),a.d(t,{default:function(){return H}});var l=a(3396);function n(e,t,a,n,i,o){const s=(0,l.up)("ClientViewIndex"),r=(0,l.up)("AdminFrame");return(0,l.wg)(),(0,l.j4)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s)])),_:1})}const i=e=>((0,l.dD)("data-v-be2d93de"),e=e(),(0,l.Cn)(),e),o={class:"settings-mediae-index-page"},s=i((()=>(0,l._)("h1",null,"媒体文件",-1)));function r(e,t,a,n,i,r){const d=(0,l.up)("MyToolbar"),u=(0,l.up)("MyPager"),m=(0,l.up)("MyTable"),c=(0,l.up)("MyUpImageDialog");return(0,l.wg)(),(0,l.iD)("div",o,[s,(0,l.Wm)(d,{onAction:r.handleAction},null,8,["onAction"]),(0,l.Wm)(u,{class:"settings-mediae-index-pager"}),(0,l.Wm)(m),(0,l.Wm)(c,{modelValue:i.displayUploadDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>i.displayUploadDialog=e)},null,8,["modelValue"])])}var d=a(4870),u=a(2748);const m={class:"toolbar"},c={name:"settings-mediae-toolbar",methods:{fire(e){let t={name:e};this.$emit("action",t)},insert(){this.fire("insert")},refresh(){this.fire("refresh")},importPresets(){this.fire("import-presets")}}};var p=Object.assign(c,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),n=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",m,[(0,l.Wm)(n,{type:"default",onClick:e.refresh},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.hYj))])),_:1}),(0,l.Uk)(" 刷新 ")])),_:1},8,["onClick"]),(0,l.Wm)(n,{type:"default",onClick:e.insert},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1}),(0,l.Uk)(" 添加 ")])),_:1},8,["onClick"]),(0,l.Wm)(n,{type:"default",onClick:e.importPresets},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37)),(0,l.Uk)(),(0,l.Wm)((0,d.SU)(u.v37))])),_:1}),(0,l.Uk)(" 导入预置资源 ")])),_:1},8,["onClick"])])}}}),h=a(89);const g=(0,h.Z)(p,[["__scopeId","data-v-0ce938ae"]]);var f=g;function v(e,t,a,n,i,o){const s=(0,l.up)("el-pagination");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(s,{"current-page":i.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>i.currentPage=e),"page-size":i.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>i.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:i.background,layout:"total, sizes, prev, pager, next",total:o.theCountItemsTotal,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var w={name:"settings-mediae-pager",computed:{theCountItemsTotal(){return this.$store.getters["media/total"]}},data(){return{currentPage:1,pageSize:10,background:!0}},methods:{handleSizeChange(e){let t=e,a=0;this.$store.commit("media/update",{index:a,size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit("media/update",{index:t})}}};const b=(0,h.Z)(w,[["render",v]]);var k=b;const _=["src"];function C(e,t,a,n,i,o){const s=(0,l.up)("el-table-column"),r=(0,l.up)("el-button"),d=(0,l.up)("el-table"),u=(0,l.up)("MyBatch");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(d,{data:o.items,onSelectionChange:o.handleSelectionChange},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"selection"}),(0,l.Wm)(s,{prop:"url",label:"",width:"90"},{default:(0,l.w5)((e=>[(0,l._)("img",{class:"media-item-image",src:e.row.url},null,8,_)])),_:1}),(0,l.Wm)(s,{prop:"label",label:"名称",sortable:""}),(0,l.Wm)(s,{prop:"content_type",label:"类型",sortable:""}),(0,l.Wm)(s,{prop:"size",label:"大小",sortable:""}),(0,l.Wm)(s,{label:"操作",width:"170px"},{default:(0,l.w5)((e=>[(0,l.Wm)(r,{link:"",type:"primary",onClick:t=>o.handleClickItemDetail(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("详情")])),_:2},1032,["onClick"]),(0,l.Wm)(r,{link:"",type:"danger",onClick:t=>o.handleClickRemoveItem(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,l.Wm)(u,{modelValue:i.selectedItems,"onUpdate:modelValue":t[0]||(t[0]=e=>i.selectedItems=e)},null,8,["modelValue"])])}var y=a(2655);const W={style:{"margin-top":"10px"}};function U(e,t,a,n,i,o){const s=(0,l.up)("el-button"),r=(0,l.up)("BatchToolBar");return(0,l.wg)(),(0,l.iD)("div",W,[(0,l.Wm)(r,{modelValue:o.items,"onUpdate:modelValue":t[0]||(t[0]=e=>o.items=e),title:"批处理",hideEmpty:!0},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"danger",onClick:o.handleDelete},{default:(0,l.w5)((()=>[(0,l.Uk)(" 删除 ")])),_:1},8,["onClick"]),(0,l.Wm)(s,{type:"primary",onClick:o.handlePutToBuffer},{default:(0,l.w5)((()=>[(0,l.Uk)(" 存入缓冲区 ")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])}var I=a(9698),S={name:"settings-intent-templates-batch",components:{BatchToolBar:I.Z},computed:{items(){return this.modelValue}},methods:{handleDelete(){let e=this.items;this.$store.dispatch("media/remove",{items:e})},handlePutToBuffer(){let e="mediae",t={};t[e]=this.items,this.$store.dispatch("jsonbuffer/put",{vo:t})}},props:{modelValue:Array}};const z=(0,h.Z)(S,[["render",U]]);var D=z,V={name:"settings-mediae-table",components:{MyBatch:D},computed:{items(){return this.$store.getters["media/list"]}},data(){return{selectedItems:[]}},methods:{handleClickItemDetail(){},handleClickRemoveItem(e){let t="移除媒体文件",a="确定要移除 ["+e.name+"] 这个媒体文件吗？",l="注意：移除该文件可能会导致引用它的内容显示不正常！";y.T.confirm(a+l,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},removeItem(e){this.$store.dispatch("media/remove",{item:e})},handleSelectionChange(e){this.selectedItems=e}}};const x=(0,h.Z)(V,[["render",C],["__scopeId","data-v-08d49d67"]]);var T=x,P=(a(7658),a(7178));const $=["src"];function A(){}const B={name:"update-up-dialog",data(){return{imageUrl:"",vo:{},item:{},fileprops:[{name:"",value:""}]}},methods:{handleAvatarSuccess(e,t){A(e);let a=e,l=a.mediae[0];this.vo=a,this.item=l,this.fileprops=this.makeFileProps(l),this.imageUrl=URL.createObjectURL(t.raw)},makeFileProps(e){const t={name:"文件名",size:"大小",content_type:"类型",sha256sum:"SHA-256"};let a=[];for(var l in t){let n=t[l],i=e[l];a.push({name:n,value:i})}return a},beforeAvatarUpload(e){return this.acceptType(e.type)?!(e.size/1024/1024>2)||(P.z8.error("文件太大了，最多支持 2MB!"),!1):(P.z8.error("不支持的文件格式!"),console.warn("不支持的文件格式: "+e.type),!1)},acceptType(e){const t=["image/jpeg","image/png","image/gif","image/svg","image/webp","image/svg+xml"];for(var a in t){let l=t[a];if(l==e)return!0}return!1},save(){let e=this.item;this.$store.dispatch("media/insert",{item:e}).then((()=>{this.close()}))},cancel(){this.close()},close(){this.$emit("update:modelValue",!1)}}};var M=Object.assign(B,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),n=(0,l.up)("el-upload"),i=(0,l.up)("el-col"),o=(0,l.up)("el-table-column"),s=(0,l.up)("el-table"),r=(0,l.up)("el-row"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"上传图片"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"avatar-uploader up-box",action:"/upload",drag:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},{default:(0,l.w5)((()=>[e.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,src:e.imageUrl,class:"avatar"},null,8,$)):((0,l.wg)(),(0,l.j4)(a,{key:1,class:"avatar-uploader-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u.v37))])),_:1}))])),_:1},8,["on-success","before-upload"])])),_:1}),(0,l.Wm)(i,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{class:"up-box",data:e.fileprops,border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{prop:"name",label:"属性"}),(0,l.Wm)(o,{prop:"value",label:"值"})])),_:1},8,["data"])])),_:1})])),_:1}),(0,l._)("div",null,[(0,l.Wm)(m,{type:"success",onClick:e.save},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1},8,["onClick"]),(0,l.Wm)(m,{type:"default",onClick:e.cancel},{default:(0,l.w5)((()=>[(0,l.Uk)(" 取消 ")])),_:1},8,["onClick"])])])),_:1})}}});const Z=(0,h.Z)(M,[["__scopeId","data-v-7061dd8c"]]);var j=Z,F={name:"settings-mediae-index",components:{MyToolbar:f,MyTable:T,MyUpImageDialog:j,MyPager:k},data(){return{displayUploadDialog:!1}},methods:{fetch(){this.$store.dispatch("media/fetch",{all:1})},upload(){this.displayUploadDialog=!0},importPresets(){this.$store.dispatch("media/import_presets",{})},handleAction(e){let t=e.name;"refresh"==t?this.fetch():"import-presets"==t?this.importPresets():"insert"==t&&this.upload()}},mounted(){this.fetch()}};const R=(0,h.Z)(F,[["render",r],["__scopeId","data-v-be2d93de"]]);var E=R,O={name:"SettingsMediaeView",components:{ClientViewIndex:E}};const L=(0,h.Z)(O,[["render",n]]);var H=L}}]);
//# sourceMappingURL=136.43154e28.js.map
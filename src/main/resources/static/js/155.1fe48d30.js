"use strict";(self["webpackChunkwpm_station_vue"]=self["webpackChunkwpm_station_vue"]||[]).push([[155],{6155:function(e,t,a){a.d(t,{Z:function(){return K}});var l=a(3396);const o=e=>((0,l.dD)("data-v-7945e7a6"),e=e(),(0,l.Cn)(),e),i={class:"settings-index-page"},n=o((()=>(0,l._)("h1",null,"本地仓库",-1)));function s(e,t,a,o,s,r){const d=(0,l.up)("MyToolbar"),u=(0,l.up)("MySearch"),c=(0,l.up)("MyPager"),m=(0,l.up)("MyTable"),p=(0,l.up)("MyEdit");return(0,l.wg)(),(0,l.iD)("div",i,[n,(0,l.Wm)(d),(0,l.Wm)(u,{class:"search-box"}),(0,l.Wm)(c,{class:"pager-box"}),(0,l.Wm)(m,{onAction:r.handleAction},null,8,["onAction"]),(0,l.Wm)(p,{modelValue:s.displayEditDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>s.displayEditDialog=e),item:s.theEditItem},null,8,["modelValue","item"])])}const r={class:"operation-buttons"};function d(e,t,a,o,i,n){const s=(0,l.up)("el-table-column"),d=(0,l.up)("FileStateView"),u=(0,l.up)("el-button"),c=(0,l.up)("el-table");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(c,{data:n.items},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{label:"名称",prop:"name",sortable:""}),(0,l.Wm)(s,{label:"路径",prop:"path",sortable:""}),(0,l.Wm)(s,{label:"状态",prop:"state",sortable:""},{default:(0,l.w5)((e=>[(0,l.Wm)(d,{code:e.row.state},null,8,["code"])])),_:1}),(0,l.Wm)(s,{label:"操作"},{default:(0,l.w5)((e=>[(0,l._)("div",r,[(0,l.Wm)(u,{type:"primary",link:"",onClick:t=>n.handleClickItemDetail(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("详情")])),_:2},1032,["onClick"]),(0,l.Wm)(u,{type:"primary",link:"",onClick:t=>n.handleClickEditItem(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("编辑")])),_:2},1032,["onClick"]),(0,l.Wm)(u,{type:"danger",link:"",onClick:t=>n.handleClickRemoveItem(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("移除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])])}a(7658);var u=a(2655),c=a(2997),m={name:"settings-local-repositories-table",components:{FileStateView:c.Z},computed:{items(){return this.$store.getters["local_repository/currentPageItems"]},currentPageIds(){let e=this.items,t=[];if(null==e)return t;for(var a in e){let l=e[a];t.push(l.id)}return t},currentPageIdstr(){let e=this.currentPageIds,t="";for(var a in e){let l=e[a];t+=l+"."}return t}},methods:{handleClickEditItem(e){let t="edit",a={name:t,item:e};this.$emit("action",a)},handleClickItemDetail(e){let t="detail",a={name:t,item:e};this.$emit("action",a)},handleClickRemoveItem(e){let t="移除仓库",a="确定要移除 ["+e.name+"] 这个仓库吗？",l="该操作不会把磁盘上的仓库数据删除，仅将对它的引用从WPM数据库中移除。";u.T.confirm(a+l,t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.removeItem(e)})).catch((()=>{}))},removeItem(e){this.$store.dispatch("local_repository/remove",e)},fetchByIds(e){this.$store.dispatch("local_repository/fetchByIds",{ids:e})}},watch:{currentPageIdstr(){this.fetchByIds(this.currentPageIds)}}},p=a(89);const h=(0,p.Z)(m,[["render",d],["__scopeId","data-v-69a4940d"]]);var g=h;function _(e,t,a,o,i,n){const s=(0,l.up)("el-pagination");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(s,{"current-page":i.currentPage,"onUpdate:currentPage":t[0]||(t[0]=e=>i.currentPage=e),"page-size":i.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>i.pageSize=e),"page-sizes":[5,10,20,50,100,200,500],background:i.background,layout:"total, sizes, prev, pager, next",total:n.theCountItemsTotal,onSizeChange:n.handleSizeChange,onCurrentChange:n.handleCurrentChange},null,8,["current-page","page-size","background","total","onSizeChange","onCurrentChange"])])}var f={name:"settings-local-repositories-table",computed:{items(){return[]},theCountItemsTotal(){return this.$store.getters["local_repository/total"]}},data(){return{currentPage:1,pageSize:10,background:!0}},methods:{handleSizeChange(e){let t=e;this.$store.commit("local_repository/update",{size:t})},handleCurrentChange(e){let t=e-1;this.$store.commit("local_repository/update",{index:t})}},mounted(){this.handleCurrentChange(this.currentPage),this.handleSizeChange(this.pageSize)}};const w=(0,p.Z)(f,[["render",_]]);var y=w,v=a(4870),C=a(2748);const b={name:"settings-local-repositories-table",computed:{},data(){return{searchtext:""}},methods:{applyFilter(e){this.searchtext=e,this.$store.commit("local_repository/update",{filter:e})}}};var k=Object.assign(b,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),o=(0,l.up)("el-button"),i=(0,l.up)("el-input");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(i,{modelValue:e.searchtext,onInput:e.applyFilter,clearable:"",placeholder:"请输入要查找的内容"},{append:(0,l.w5)((()=>[(0,l.Wm)(o,{title:"查找"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.olm))])),_:1})])),_:1})])),_:1},8,["modelValue","onInput"])])}}});const W=k;var I=W;const S=e=>((0,l.dD)("data-v-af56694a"),e=e(),(0,l.Cn)(),e),V={class:"mode-list"},U=S((()=>(0,l._)("div",{class:"mode-item-icon"},[(0,l._)("img",{class:"mode-item-icon-img",src:"/image/icon_repo.png"})],-1))),M={class:"mode-item-label"},x=S((()=>(0,l._)("span",{class:"mode-item-label-text"}," 导入单个仓库 ",-1))),D=S((()=>(0,l._)("div",{class:"mode-item-icon"},[(0,l._)("img",{class:"mode-item-icon-img",src:"/image/icon_repos.png"})],-1))),z={class:"mode-item-label"},$=S((()=>(0,l._)("span",{class:"mode-item-label-text"}," 批量导入仓库 ",-1))),P={name:"settings-insert-local-repo-mode-dialog",data(){return{}},methods:{importMulti(){this.$router.push("/import-local-repositories")},importOne(){this.$router.push("/import-local-repository")},close(){this.updateModelValue(!1)}},props:{}};var T=Object.assign(P,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),o=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(o,{title:"请选择"},{default:(0,l.w5)((()=>[(0,l._)("div",V,[(0,l._)("div",{class:"mode-item",onClick:t[0]||(t[0]=(...t)=>e.importOne&&e.importOne(...t))},[U,(0,l._)("div",M,[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.v37))])),_:1}),x])]),(0,l._)("div",{class:"mode-item",onClick:t[1]||(t[1]=(...t)=>e.importMulti&&e.importMulti(...t))},[D,(0,l._)("div",z,[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.v37))])),_:1}),(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.v37))])),_:1}),$])])])])),_:1})}}});const E=(0,p.Z)(T,[["__scopeId","data-v-af56694a"]]);var O=E;const Z={class:"toolbar"},j={name:"settings-local-repositories-toolbar",components:{MyInsertModeDialog:O},data(){return{displayInsertModeDialog:!1}},methods:{fetch(){this.$store.dispatch("local_repository/fetch",{})},handleClickAdd(){this.displayInsertModeDialog=!0},handleClickRefresh(){this.fetch()}},mounted(){this.fetch()}};var F=Object.assign(j,{setup(e){return(e,t)=>{const a=(0,l.up)("el-icon"),o=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",Z,[(0,l.Wm)(o,{onClick:e.handleClickRefresh,title:"刷新"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.hYj))])),_:1})])),_:1},8,["onClick"]),(0,l.Wm)(o,{onClick:e.handleClickAdd,title:"添加本地仓库"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,v.SU)(C.v37))])),_:1})])),_:1},8,["onClick"]),(0,l.Wm)(O,{modelValue:e.displayInsertModeDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.displayInsertModeDialog=t)},null,8,["modelValue"])])}}});const A=(0,p.Z)(F,[["__scopeId","data-v-87cbbbea"]]);var B=A,R=a(7139);function J(e,t,a,o,i,n){const s=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),u=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"修改仓库",modelValue:a.modelValue,"onUpdate:modelValue":n.updateModelValue},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{"label-width":"120px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"名称"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:i.item1.name,"onUpdate:modelValue":t[0]||(t[0]=e=>i.item1.name=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"路径"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:i.item1.path,"onUpdate:modelValue":t[1]||(t[1]=e=>i.item1.path=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"路径（工作区）"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,R.zw)(i.item1.workspace_path),1)])),_:1}),(0,l.Wm)(r,{label:"路径（库）"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,R.zw)(i.item1.repository_path),1)])),_:1}),(0,l.Wm)(r,{label:"描述"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"textarea",modelValue:i.item1.description,"onUpdate:modelValue":t[2]||(t[2]=e=>i.item1.description=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l._)("div",null,[(0,l.Wm)(u,{type:"success",onClick:n.handleClickSave},{default:(0,l.w5)((()=>[(0,l.Uk)("保存")])),_:1},8,["onClick"]),(0,l.Wm)(u,{type:"default",onClick:n.handleClickCancel},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","onUpdate:modelValue"])}var N={name:"local-repo-item-edit",data(){return{item1:{}}},methods:{updateModelValue(e){this.$emit("update:modelValue",e)},handleClickSave(){let e=this.item1;this.$store.dispatch("local_repository/update",e).then((()=>{this.close()}))},handleClickCancel(){this.close()},close(){this.updateModelValue(!1)}},props:{modelValue:Boolean,item:Object},watch:{item(e){let t=JSON.stringify(e);this.item1=JSON.parse(t)}}};const Y=(0,p.Z)(N,[["render",J]]);var q=Y,G={name:"settings-local-repositories",components:{MyTable:g,MyPager:y,MySearch:I,MyToolbar:B,MyEdit:q},data(){return{displayEditDialog:!1,theEditItem:{}}},methods:{handleAction(e){let t=e.name;"edit"==t?this.editItem(e.item):"detail"==t?this.openItemDetail(e.item):console.warn("unsupported action:"+t)},editItem(e){this.theEditItem=e,this.displayEditDialog=!0},openItemDetail(e){this.nop(e)},nop(){}}};const H=(0,p.Z)(G,[["render",s],["__scopeId","data-v-7945e7a6"]]);var K=H},2997:function(e,t,a){a.d(t,{Z:function(){return g}});var l=a(3396),o=a(4870),i=a(9242),n=a(7139),s=a(2748);const r=["title"],d={class:"state-text"},u={ready:{type:"success",text:"正常"},moved:{type:"warn",text:"已搬迁"},offline:{type:"error",text:"找不到"}},c={name:"file-state",computed:{stateText(){return this.stringifyState(this.code)},statetype(){return this.getStateType(this.code)}},data(){return{}},methods:{stringifyState(e){let t=u[e];return null==t?e:t.text},getStateType(e){let t=u[e];return null==t?e:t.type}},props:{code:String}};var m=Object.assign(c,{setup(e){return(t,a)=>{const u=(0,l.up)("el-icon");return(0,l.wg)(),(0,l.iD)("div",{title:e.code},[(0,l.wy)((0,l.Wm)(u,{class:"state-icon-ok"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,o.SU)(s.c5o))])),_:1},512),[[i.F8,"success"==t.statetype]]),(0,l._)("span",d,(0,n.zw)(t.stateText),1),(0,l.wy)((0,l.Wm)(u,{class:"state-icon-warn"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,o.SU)(s.hg5))])),_:1},512),[[i.F8,"warn"==t.statetype]]),(0,l.wy)((0,l.Wm)(u,{class:"state-icon-error"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,o.SU)(s.Tw$))])),_:1},512),[[i.F8,"error"==t.statetype]])],8,r)}}}),p=a(89);const h=(0,p.Z)(m,[["__scopeId","data-v-39ae21a4"]]);var g=h}}]);
//# sourceMappingURL=155.1fe48d30.js.map